import sys
import os
from pathlib import Path 
import re


re_use_filename = re.compile('(?<=Benign\/)(.*)(?=.c)')
print('\nGenerating benign assembly: \n')
for filename in Path('./CompiledPrograms/Benign').rglob('*.c'):
    output_name = re_use_filename.search(str(filename))
    os.system('gcc -S -fno-asynchronous-unwind-tables -masm=intel -w ./{0} -o ./CompiledPrograms/Benign/Assembly/{1}'.format(filename, output_name[0]))
    print('Compiled file: ', output_name[0])


re_use_filename = re.compile('(?<=Vulns\/)(.*)(?=.c)')

print('\nGenerating vulnerable assembly: \n')
for filename in Path('./CompiledPrograms/Vulns').rglob('*.c'):
    output_name = re_use_filename.search(str(filename))
    os.system('gcc -S -fno-asynchronous-unwind-tables -masm=intel -w ./{0} -o ./CompiledPrograms/Vulns/Assembly/{1}'.format(filename, output_name[0]))
    print('Compiled file: ', output_name[0])

