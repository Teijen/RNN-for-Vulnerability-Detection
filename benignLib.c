#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>

/*Start declalaction*/
void notSafeCopy(char* src);
void notSafeMerging(char* s);
void notSafeDifferentSizedStrings(char* s);
void notSafeMessageOverflow(char* s);
void concatenateOverStringStrcpy(char* s);
int validateBufferStrcpy(char* s);
void validateIndexOverflowArryStrcpy(int n, char* s);
void flushingAfterStrCpy(char* s);

void notSafeToCopy(char* s, int n);
void notSafeDynamicCopyStrncpy();
void notSafeDifferentSizeableStringStrncpy(char* s);
void notSafeDifferentSizedStringsStrncpy(char*s, int n);
void concatenateOverStringStrncpy(char* s);
void ignoreIndexOverflowArrysStrncpy();
void strncpysLimitedInput(int n);
void strncpyInputSplits();

void concatenateOverString(char* s, char* t); 
void ignoreBuffer(char* s);
void ignoreIndexOverflowArrys(char* s);
void notSafeCopyStrcat(char* s);
void notSafeDynamicCopyStrcat(char* s, int n);
void notSafeDifferentSizeableStringStrcat(char* s);
void notSafeMessageOverflowStrcat(char* s);
void inputStrCat(char* s);

void inputBuffer();
void issueMultipleScanfs();
void scanfInput();
void shortingSplittingScanf();
void notSafegetCopyScanf(int n);
void changeSizeStringScanf();
void overflowScanf();
void buffercopyScanf();


void smallSprintf(char* s);
void limitedSprintSprintf(char* s);
void flushingUnreadSprintf(char* s);
void tooLongStringSpritf();
void notSafeSprintf(char* s);
void notSafeSprintfMul(char* s, char* t);
void notSafegetSprintfTwo(int n);
void overflowSprintfWithArrayTwo(char* s);

void fgetsSmallBuffer();
void fgetsSmallBufferWithArg(char* s);
void fgetsConstantTooLong();
void fgetsWithDynamicSize();
char* fgetsWithReturnAndSmallArray();
int fgetsWithMalloc();
void fgetsPlaceInArray();
int fgetsThreeFgets();

/*End declalaction*/



int main(int argc, char* argv[]){
    /*Call start*/
    // notSafeCopy(argv[1]);
    // notSafeMerging(argv[1]);
    // notSafeDifferentSizedStrings(argv[1]);
	// notSafeMessageOverflow(argv[1]);
    // concatenateOverStringStrcpy(argv[1]);
    // validateBufferStrcpy(argv[1]);
	// validateIndexOverflowArryStrcpy(strtol(argv[1], NULL, 10), argv[2]);
	// flushingAfterStrCpy(argv[1]);

	// notSafeToCopy(argv[1], strtol(argv[2], NULL, 10));
	// notSafeDynamicCopyStrncpy();
	// notSafeDifferentSizeableStringStrncpy(argv[1]);
	// notSafeDifferentSizedStringsStrncpy(argv[1], strtol(argv[2], NULL, 10));
	// concatenateOverStringStrncpy(argv[1]);
	// ignoreIndexOverflowArrysStrncpy();
	// strncpysLimitedInput(strtol(argv[1], NULL, 10));
	// strncpyInputSplits();

	// concatenateOverString(argv[1], argv[2]); 
	// ignoreBuffer(argv[1]);
	// ignoreIndexOverflowArrys(argv[1]);
	// notSafeCopyStrcat(argv[1]);
	// notSafeDynamicCopyStrcat(argv[1], strtol(argv[2], NULL, 10));
	// notSafeDifferentSizeableStringStrcat(argv[1]);
	// notSafeMessageOverflowStrcat(argv[1]);
    // inputStrCat(argv[1]);

	// inputBuffer();
	// issueMultipleScanfs();
	// scanfInput();
	// shortingSplittingScanf();
	// notSafegetCopyScanf(strtol(argv[1], NULL, 10));
	// changeSizeStringScanf();
	// overflowScanf();
	// buffercopyScanf();

	// smallSprintf(argv[1]);
	// limitedSprintSprintf(argv[1]);
	// flushingUnreadSprintf(argv[1]);
	// tooLongStringSpritf();
	// notSafeSprintf(argv[1]);
	// notSafeSprintfMul(argv[1], argv[2]);
	// notSafegetSprintfTwo(strtol(argv[1], NULL, 10));
	// overflowSprintfWithArrayTwo(argv[1]);

	// fgetsSmallBuffer();
	// fgetsSmallBufferWithArg(argv[1]);
	// fgetsConstantTooLong();
	// fgetsWithDynamicSize();
    // fgetsWithReturnAndSmallArray();
	// fgetsWithMalloc();
	// fgetsPlaceInArray();
	// fgetsThreeFgets();

    /*Call end*/

}


/*funcstart*/
void notSafeCopy(char* src){
	char dest[14];
    if(strlen(src) > sizeof(dest)){
        char longer[strlen(src)];
        strcpy(longer, src);
	    printf("Copied string: %s\n", longer);
    }else{
	    strcpy(dest, src);
	    printf("Copied string: %s\n", dest);
    }
}
/*funcend*/
/*funcstart*/
void notSafeMerging(char* s){
	char dest[15] = "Testing second";
	printf("Before: %s", dest);
    if(strlen(s) > sizeof(dest)){
        char longer[strlen(s)];
        strcpy(longer, s);
	    printf("After: %s\n", longer);
    }else{
	    strcpy(dest, s);
	    printf("After: %s\n", dest);
    }
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStrings(char* s){
	char src[40];
	char dest[strlen(s)];
	memset(dest, '\0', sizeof(dest));
	strcpy(src, "This is somesiteilike.com");
	strcpy(dest, src);
	strcpy(dest, s);
	printf("Final copied string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeMessageOverflow(char* s){
	char example[strlen(s)];
	memset(example, '\0', sizeof(example));
	strcpy(example, s);
	printf("%s\n", example);
}
/*funcend*
/*funcstart*/
void concatenateOverStringStrcpy(char* s){
	char* str1;
	char* str2;
	str1 = strdup("String");
    str2 = strdup("test");
    printf("%s\n", str1);
    printf("%s\n", str2);
	char dest[strlen(s)];
	strcpy(dest, s);
}
/*funcend*/
/*funcstart*/
int validateBufferStrcpy(char* s) {
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 81){
		strcpy(buf, s);
        printf("%s\n",buf);
        return 0;
    }
    return 0;
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArryStrcpy(int n, char* s){
    if(n < strlen(s)){
        n = strlen(s);
    }
	char dest[n];
	strcpy(dest, s);
	printf("dest : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void flushingAfterStrCpy(char* s){
   	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%50;
	int c = rand()%50;
	printf("%d, %d, %d\n",a,b,c);
    if(a < strlen(s)){
        a = strlen(s);
    }
	char dest[a];
	strcpy(dest, s);
	printf("%s\n", s);
}
/*funcend*/
/*funcstart*/
void notSafeToCopy(char*s, int n){
	if(n<strlen(s)){
		n = strlen(s);
		char dest[n];
		strncpy(dest, s, strlen(s));
		printf("Copied string: %s\n", dest);
	}else{
		char dest[n];
		strncpy(dest, s, strlen(s));
		printf("Copied string: %s\n", dest);
	}
}
/*funcend*/
/*funcstart*/
void notSafeDynamicCopyStrncpy(){
	int n; 
	char tmp[256];
	printf("Enter size of string:\n");
	scanf("%d", &n);
    if(n<256){
        n = 256;
    }
	char dest[n];
	while((n= getchar()) != '\n' && n != EOF);
	printf("Enter string to store:\n");
	fgets(tmp, 256, stdin);
	strncpy(dest, tmp, strlen(tmp));
	printf("Final %s\n",dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableStringStrncpy(char*s ){
	char* greeting = "Hello mr/ms:       ";
	char fin[strlen(s)+strlen(greeting)];
	strcat(fin, greeting);
	strncpy(&fin[strlen(greeting)],s,strlen(s));
	printf("%s\n", fin);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStringsStrncpy(char* s, int n){
	int x, y, z;
	x = n+n;
	y = n-n;
	z = n*n;
	char dest[n];
	strncpy(dest, s, n);
	printf("Copied string: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void concatenateOverStringStrncpy(char* s){
	char tmp[strlen(s)];
	char dest[50];
	printf("%d vs %d\n", sizeof(tmp), sizeof(dest));
	strncpy(tmp, s, strlen(s));
	tmp[0] = 'A';
	tmp[1] = 'B';
	tmp[2] = 'C';
	if(sizeof(tmp)>sizeof(dest)){
		printf("Copied string: %s\n", tmp);

	}else{
		strncpy(dest, tmp, strlen(s));
		printf("Copied string: %s\n", dest);
	}
}
/*funcend*/
/*funcstart*/
void ignoreIndexOverflowArrysStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "string", "any" };
	int t;
	srand((unsigned) time(&t));
	int a = rand()%5;
	strncpy(sentence, article[a], 10);
	printf("%s\n", sentence);
	fgets(sentence, sizeof(sentence), stdin);
}
/*funcend*/
/*funcstart*/
void strncpysLimitedInput(int n){
	char name[50];
	char name2[n];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 50, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strncpy(name2, name, n);
    printf("%s\n",name2);
}
/*funcend*/
/*funcstart*/
void strncpyInputSplits(){
	int n = 0;
	char fin[5];
	printf("What is the size you want to allocate?\n");
	scanf("%d", &n);
	char buff[n];
	while((n= getchar()) != '\n' && n != EOF);
	printf("Enter the string you want to store:\n");
	fgets(buff, n, stdin);
	for(int i = 0; i < strlen(buff); i++){
		printf("%c", buff[i]);
	}
	printf("\n");
	if(n > sizeof(fin)){
		printf("final string %s\n", buff);

	}else{
		strncpy(fin, buff, strlen(buff));
		printf("final string %s\n", fin);
	}
}
/*funcend*/
/*funcstart*/
void concatenateOverString(char* s, char* t){
	char tmp[strlen(s)+strlen(t)];
	char dest[strlen(s)+strlen(t)];
	strcat(tmp, s);
	strcat(tmp,t);
	strcat(dest, tmp);
	printf("New String : %s\n",dest); 
}
/*funcend*/
/*funcstart*/
void ignoreBuffer(char* s) {
	char* greeting = "Hello mr/ms:       ";
	char fin[strlen(s)+strlen(greeting)];
	strcat(fin, greeting);
	strcat(fin,s);
}
/*funcend*/
/*funcstart*/
void ignoreIndexOverflowArrys(char* s){
	char sentence[strlen(s)];
	char *article[5] = { "the", "a", "one", "some", "any" };
	int val = rand() % 4;
	strcat(sentence, article[val]);
	strcat(sentence, s);
}
/*funcend*/
/*funcstart*/
void notSafeCopyStrcat(char* s){
	char* src = "Testing input string, what happened:";
	int n = 4;
	int m = n*n;
	int x = m*m; 
	char dest[strlen(s)+ strlen(src)];
	strcat(dest, src);
	strcat(dest, s);
	printf("input string: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDynamicCopyStrcat(char* s, int n){
	int x = n*n;
	int y = n+n;
	int z = 2*n/3;
	char dest[strlen(s)];
	strcat(dest, s);
	printf("%s final \n",dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableStringStrcat(char* s){
	char* first = "First";
	char* second = "Second";
	char* third = "Third";
	int n = strlen(third)*2;
	if(n < strlen(s)){
		n = strlen(s); 
	}
	char dest[strlen(first)+strlen(second)+n];
	strcat(dest, first);
	strcat(dest, second);
	strcat(dest, third);
	strcat(dest, s);
}
/*funcend*/
/*funcstart*/
void notSafeMessageOverflowStrcat(char* s){
	char example[strlen(s)+15];
	strcat(example, "Hello mr. ms: ");
	strcat(example, s);
}
/*funcend*/
/*funcstart*/
void inputStrCat(char *s){
	char tmp[20] = "This is a test String";
	char test [strlen(s)];
	for(int i = 0; i < strlen(test); i++){
		memset(&test[i], 'A', 1);
	}
	printf("%s\n", test);
	strcat(test,s); 
}
/*funcend*/
/*funcstart*/
void inputBuffer(){
	char str[100];
	scanf("%100s", str);
	printf("x = %d, str = %s\n", str, str);
}
/*funcend*/
/*funcstart*/
void issueMultipleScanfs(){
	int size;
	printf("Enter size of input ");
	scanf("%d", &size);
	char dest[size];
	snprintf(dest, sizeof(dest), "%%%ds", size - 1);
	printf("Enter string input ");
	scanf(dest, dest);
	printf("final: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void scanfInput(){
	int a = 4;
	int b = 7;
	int c = a+b;
	printf("%d Total: \n",c);
	char buffer_input[10];
	scanf("%10s", buffer_input);
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/
/*funcstart*/
void shortingSplittingScanf(){
	int x;
	char str[12] = "hello good day";
	int len = 10;
	scanf("%12s", str);
	for (x = 0; x <= len; x++){
		if (str[x] == '\n'){
			str[x] = '\0';
			break;
		}
	}
	printf("You entered: %s\n", str);
}
/*funcend*/
/*funcstart*/
void notSafegetCopyScanf(int n){
	printf("Your total size available: %d\n", n);
	char str1[n];
	snprintf(str1, sizeof(str1), "%%%ds", n - 1);
	scanf(str1, str1);
}
/*funcend*/
/*funcstart*/
void changeSizeStringScanf(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	scanf("%40s", src);
	strcpy(dest, src);
	printf("Final string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void overflowScanf(){
	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%70;
	int c = rand()%10;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char example[f];
	snprintf(example, sizeof(example), "%%%ds", f - 1);
	scanf(example, example);
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void buffercopyScanf(){
	char p[15];
	char* hw;
	int i;
	scanf("%15s", &p);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	printf("%s\n",hw);
}
/*funcend*/
/*funcstart*/
void smallSprintf(char* s){
	char buf[20];
    sprintf(buf,"You entered: %*.*s\n",0,sizeof(buf)-10,s);
    printf("%s\n",buf);
}
/*funcend*/
/*funcstart*/
void limitedSprintSprintf(char* s ){
	char number[5];
	int sum;
	printf("Enter any number\n");
	fgets(number, sizeof(number),stdin);
	sum = atoi(number);
	char dest[sum];
	char tmp[100];
	sprintf(tmp, "Final string %*.*s",0,sizeof(tmp)-10, s);
	printf("%s\n", tmp);
}
/*funcend*/
void flushingUnreadSprintf(char* s){
	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%70;
	int c = rand()%10;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char dest[strlen(s)]; 
	sprintf(dest,"%s",s);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void tooLongStringSpritf(){
	char buf[20] = "Greetings mr. /ms:";
	char name[40];
	char dest[sizeof(buf)+ sizeof(name)+13]; 
	printf("Enter your name :\n");
	fgets(name,40,stdin );
	sprintf(dest,"final: %s %s",buf,  name);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeSprintf(char* s){
	char buf[20] = "Greetings mr. /ms:";
	char dest[strlen(s)]; 
	sprintf(dest,"final: %s %s",buf, s);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeSprintfMul(char* s, char* t){
	char final[strlen(s)+strlen(t)];
	char temp[strlen(s)+strlen(t)];
	strcat(temp, s);
	strcat(temp, t);
	sprintf(final, " str : %s", temp);
	printf("%s\n", final);
}
/*funcend*/
/*funcstart*/
void notSafegetSprintfTwo(int n){
	char buf[50];
	if(n>10){
		printf("Number greater than 10\n");
		fgets(buf, 50, stdin);
	}else{
		printf("Number less than or equal to 10\n");
		fgets(buf, 50, stdin);
	}
	if(n<50){
		n = 50;
	}
	char final[n];
	sprintf(final,"You entered : %s",buf);
	printf("%s\n", final);
}
/*funcend*/
/*funcstart*/
void overflowSprintfWithArrayTwo(char* s){
	char example[strlen(s)];
	example[0] = "A";
	example[1] = "B";
	example[2] = "C";
	sprintf(example,"%s\n", s);
	printf("final : %s\n", example);
}
/*funcend*/
/*funcstart*/
void fgetsSmallBuffer(){
    char str[2];
    fgets(str,sizeof(str),stdin);
    printf("%d and %s\n",sizeof(str), str);
}
/*funcend*/
/*funcstart*/
void fgetsSmallBufferWithArg(char* s){
    printf("Argument string: %s\n",s);
	char str[50];
	if(strlen(s)>sizeof(str)){
    	fgets(str, sizeof(str), stdin);
    	printf("Written string: %s\n",str);
	}else{
    	fgets(str, strlen(s), stdin);
    	printf("Written string: %s\n",str);
	}
}
/*funcend*/
/*funcstart*/
void fgetsConstantTooLong(){
    const int DATA_SIZE = 64;
    char buffer[DATA_SIZE];
    printf("Write your username: \n");
    fgets(buffer, DATA_SIZE, stdin);
    printf("Hello, %s",buffer);
}
/*funcend*/
/*funcstart*/
void fgetsWithDynamicSize(){
    int size; 
    printf("Enter size of input\n"); 
    scanf("%d",&size);
    char buffer[size];
    while((size= getchar()) != '\n' && size != EOF);
    fgets(buffer, size, stdin);
}
/*funcend*/
/*funcstart*/
char* fgetsWithReturnAndSmallArray(){
    char* inn[10];
    printf("%d\n",sizeof(int));
    fgets(inn,sizeof(char)*sizeof(inn),stdin);
    return inn; 
}
/*funcend*/
/*funcstart*/
int fgetsWithMalloc(){
    int size, width; 
    printf("Enter two numbers to add :\n");
    scanf("%d%d",&size, &width);
	printf("Total of the two :%d\n", size+width);
    while((size= getchar()) != '\n' && size != EOF);
    char string[50];
	printf("%d mul: \n", size*width);
    fgets(string, sizeof(string), stdin);
	printf("%s\n", string);
    return 0; 
}
/*funcend*/
/*funcstart*/
void fgetsPlaceInArray(){
    char test[20];
    printf("%d\n", sizeof(test));
    memset(test, 'a', sizeof(test));
    printf("%s\n",test);
    fgets(test, 20, stdin);
	int pos = 15;
    fgets(&test[pos], sizeof(test)-pos, stdin);
    printf("%s\n",test);
}
/*funcend*/
/*funcstart*/
int fgetsThreeFgets(){
    int j = 10;
	int k = 10;
    int i = 0;
    scanf("%d",&i);
    char writes[k+j+i];
	while((i= getchar()) != '\n' && i != EOF);
	fgets(writes, i,stdin);
    fgets(writes, k,stdin);
    fgets(writes, j, stdin);
	return 0;
}
/*funcend*/
