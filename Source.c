#include <stdio.h>


//Strcpy

void notSafeCopy()
{
	char src[] = "Testing input string";

	char dest[14];

	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafeDynamicCopy()
{
	char *str1 = "abcdefghijklmnop";
	char *str2 = malloc(100);
	strcpy(str2, str1); 
	str2[0] = 'A';
	free(str2);
}


void notSafeMerging()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *ps = src + 4;
	char *pd = dest + strlen(dest);

	strcpy(pd, ps);
	printf(dest);
}

void notSafeDifferentSizeableString()
{
	char dest[15] = "abcdefghijklmn";

	char *sp = dest + 5;
	char *dp = dest + 8;

	printf(sp);
	printf(dp);
}

void notSafeDifferentSizedStrings()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	strcpy(src, "This is alphsstr.com");
	strcpy(dest, src);

	printf("Final copied string : %s\n", dest);
}

void notSafeMessageOverflow()
{
	char example[50];

	strcpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");

	printf("%s\n", example);
}

void concatenateOverStringStrcpy()
{
	char*   str1;
	char*   str2;

	str1 = strdup("String");

	strcpy(str2,"This shall be after my backslash 0 in str1");
	printf("New String : %s\n", strcat(str1, str2));
}

void ignoreBufferStrcpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	strcat(buf, s);
}

void validateBufferStrcpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 77)
		strcat(buf, s);
}

void ignoreIndexOverflowArrysStrcpy()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };

	int val = rand() % 4;
	strcpy(sentence, article[val]);
	strcpy(sentence, " ");
	printf(sentence);
}

void validateIndexOverflowArryStrcpy()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };

	int val = rand() % 4;
	if (val >= 0 && val <= 4)
	{
		strcpy(sentence, article[val]);
		strcpy(sentence, " ");
		printf(sentence);
	}
}

void strcpysLimitedInput()
{
	char name[10];
	char name2[10];
	for (int i = 0; i <= 10; i++)
	{
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			printf("Your string is: , %s.\n", name);
	}
	strcpy(name2, name);
}

void flushingAfterStrCpy()
{
	char *name;
	strcpy(name, "hello");
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	print(name);
}

void nonCompliantStrcpy(void) {
	char buf[8];
	strcpy(buf, "helloworld");
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}

void strcpyInputSplits()
{
	char buffer_input[10];

	fgets(buffer_input, 10, stdin);
	strcpy(buffer_input, "hello world");
	printf("You entered: %s\n", buffer_input);
}

//Strncpy
void safeToCopy()
{
	char src[] = "Testing input string";
	char dest[14];
	strncpy(dest, src, 14);
	printf("Copied string: %s\n", dest);
}

void safeDynamicCopy()
{
	char *str1 = "abcdefghijklmnop";
	char *str2 = malloc(100);
	strncpy(str2, str1);
	str2[0] = 'A';
}

void notSafeMergingStrncpy(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strncpy(pd, ps);
	printf(dest);
}

void notSafeDifferentSizeableStringStrncpy()
{
	char dest[15] = "abcdefghijklmn";

	char *sp = dest + 5;
	char *dp = dest + 8;

	printf(sp);
	printf(dp);
}

void notSafeDifferentSizedStringsStrncpy()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	strncpy(src, "This is alphsstr.com");
	strncpy(dest, src);

	printf("Final copied string : %s\n", dest);
}

void notSafeMessageOverflowStrncpy(){
	char example[50];
	strcpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");
	printf("%s\n", example);
}

void concatenateOverStringStrncpy()
{
	char*   str1;
	char*   str2;

	str1 = strdup("String");

	strncpy(str2, "This shall be after my backslash 0 in str1");
	printf("New String : %s\n", strcat(str1, str2));
}

void ignoreBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, "s: ");
	strcat(buf, s);
}

void validateBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, "s: ");
	if (strlen(s) < 77)
		strcat(buf, s);
}

void ignoreIndexOverflowArrysStrncpy()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };

	int val = rand() % 4;
	strncpy(sentence, article[val]);
	strncpy(sentence, " ");
	printf(sentence);
}

void validateIndexOverflowArryStrncpy()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };

	int val = rand() % 4;
	if (val >= 0 && val <= 4)
	{
		strncpy(sentence, article[val]);
		strncpy(sentence, " ");
		printf(sentence);
	}
}

void strncpysLimitedInput()
{
	char name[10];
	char name2[10];
	for (int i = 0; i <= 10; i++)
	{
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			printf("Your string is: , %s.\n", name);
	}
	strncpy(name2, name);
}

void flushingAfterStrnCpy()
{
	char *name;
	strncpy(name, "hello");
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	print(name);
}

void nonCompliantStrncpy(void) {
	char buf[8];
	strncpy(buf, "helloworld");
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}

void strncpyInputSplits()
{
	char buffer_input[10];

	fgets(buffer_input, 10, stdin);
	strncpy(buffer_input, "hello world");
	printf("You entered: %s\n", buffer_input);
}

//strcat
void concatenateOverString()
{
	char*   str1;
	char*   str2;

	str1 = strdup("String");

	str2 = strdup("This shall be after my backslash 0 in str1");
	printf("New String : %s\n", strcat(str1, str2));
}

void ignoreBuffer() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	strcat(buf, s);  
}

void validateBuffer() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 77)
		strcat(buf, s); 
}

void ignoreIndexOverflowArrys()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };
	int val = rand() % 4;
	strcat(sentence, article[val]);
	strcat(sentence, " ");
	printf(sentence);
}

void validateIndexOverflowArrys()
{
	char sentence[100] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };

	int val = rand() % 4;
	if (val >= 0 && val <= 4)
	{
		strcat(sentence, article[val]);
		strcat(sentence, " ");
		printf(sentence);
	}
}


void notSafeCopyStrcat()
{
	char src[] = "Testing input string";

	char dest[14];

	strcat(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafeDynamicCopyStrcat()
{
	char *str1 = "abcdefghijklmnop";
	char *str2 = malloc(100);
	strcat(str2, str1);
	str2[0] = 'A';
}

void notSafeMergingStrcat()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *ps = src + 4;
	char *pd = dest + strlen(dest);

	strcat(pd, ps);
	printf(dest);
}

void notSafeDifferentSizeableStringStrcat()
{
	char dest[15] = "abcdefghijklmn";

	char *sp = dest + 5;
	char *dp = dest + 8;
	strcat(sp, dp);
	printf(sp);
	printf(dp);
}

void notSafeDifferentSizedStringsStrcat()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	strcat(src, "This is alphsstr.com");
	strcat(dest, src);

	printf("Final copied string : %s\n", dest);
}

void notSafeMessageOverflowStrcat()
{
	char example[50];

	strcat(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");

	printf("%s\n", example);
}

void inputBufferStrCat()
{
	int x;
	char str[100];
	strcat(x,"hello world");
	fgets(str, 100, stdin);
	printf("x = %d, str = %s", x, str);
}

void StrCatMultipleScanfs()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	strcat(c,'a');

	printf("Length:");
	scanf("%d", &size);
}

void issueUsernameMatchStrCat()
{
	char username[20];

	printf("Enter your name: ");
	strcat(username,"abc");

	printf("Hello %s\n", username);
}

void fgetsInputStrCat()
{
	char buffer_input[10];

	strcat(buffer_input,"hello world");
	printf("You entered: %s\n", buffer_input);
}

//scanf
void inputBuffer()
{
	int x;
	char str[100];
	scanf("%d", &x);
	fgets(str, 100, stdin);
	printf("x = %d, str = %s", x, str);
}

void issueMultipleScanfs()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);

	printf("Length:");
	scanf("%d", &size);
}

void issueUsernameMatchScanf()
{
	char username[20];

	printf("Enter your name: ");
	scanf("%s", username);

	printf("Hello %s\n", username);
}

void fgetsInputScanf()
{
	char buffer_input[10];

	scanf("%s", &buffer_input);
	printf("You entered: %s\n", buffer_input);
}

void shortingSplittingScanf()
{
	int x;
	char *str = "hello good day";
	int len = 10;
	fgets(str, len, stdin);
	scanf("%s", &str);
	for (x = 0; x <= len; x++)
	{
		if (str[x] == '\n')
		{
			str[x] = '\0';
			break;
		}
	}
}

void notSafeGetsScanf()
{
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	scanf("%s", &src);
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafegetCopyScanf()
{
	char *str1[15];
	fgets(str1, 14, stdin);
	scanf("%s", &str1);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	str2[0] = 'A';
}

void notSafegetSMergeScanf()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	fgets(src, 10, stdin);
	scanf("%s", &src);
	char *ps = src + 2;
	strcpy(pd, ps);
	printf(dest);
}

void resizeableGetScanf()
{
	char dest[100];
	scanf("%s", &dest);

	char *sp = dest + 5;
	char *dp = dest + 8;

	printf(sp);
	printf(dp);
}

void changeSizeStringScanf()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	scanf("%s", &src);
	strcpy(dest, src);

	printf("Final string : %s\n", dest);
}

void fgetSOverflowScanf()
{
	char example[50];

	scanf("%s", &example);

	printf("%s\n", example);
}

void fgetBuffercopyScanf()
{
	char p[15];
	char* hw;
	int i;
	scanf("%s", &p);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	print(hw);
}

void vulnerableBufferScanf()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };
	scanf("%s", &username);
	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
}

void inputGetSWithScanfGets()
{
	int x;
	char str[100];
	scanf("%d", &x);
	scanf("%s", &str);
	printf("x = %d, str = %s", x, str);
}

void issueMultipleScanf()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	scanf("%c", &c);
	printf("Length:");
	scanf("%d", &size);
}

//memcpy
void memcpyBufferCopy()
{
	char *p = "hello";
	char* hw;
	int i;

	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	print(hw);
}

void vulnerBufferMemcpy()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };

	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
}

void nonCompliantmemcpy(void) {
	char buf2[8] = "testing";
	char *buf[8];
	memcpy(buf, buf2);
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}

void fgetsInputmemcpy()
{
	char buffer_input[10];

	fgets(buffer_input, 10, stdin);
	memcpy(buffer_input, "hello");
	printf("You entered: %s\n", buffer_input);
	
}

void shortingSplittingmemcpy()
{
	int x;
	char *str = "hello good day";
	int len = 10;
	fgets(str, len, stdin);
	for (x = 0; x <= len; x++)
	{
		if (str[x] == '\n')
		{
			str[x] = '\0';
			break;
		}
	}
	memcpy(str, "hello world");
}

void notSafememcpy()
{
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	memcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafegetmemcpy()
{
	char *str1[15];
	fgets(str1, 14, stdin);
	char *str2 = malloc(100);
	memcpy(str2, str1);
	str2[0] = 'A';
}

void notSafegetmemcpy()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	fgets(src, 10, stdin);
	char *ps = src + 2;
	memcpy(pd, ps);
	printf(dest);
}

void resizeablememcpy()
{
	char dest[100];
	fgets(dest, 15, stdin);

	char *sp = dest + 5;
	char *dp = dest + 8;
	memcpy(sp, dp);
	printf(sp);
	printf(dp);
}

void changeSizememcpy()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	fgets(src, 20, stdin);
	memcpy(src, "united states");
	strcpy(dest, src);

	printf("Final string : %s\n", dest);
}

void fgetSOverflowmemcpy()
{
	char example[50];

	fgets(example, 40, stdin);
	memcpy(example, example + 5);
	printf("%s\n", example);
}

void fgetBuffermemcpy()
{
	char p[15];
	char* hw;
	int i;
	fgets(p, 10, stdin);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	print(hw);
}

void vulnerFgetsmemcpy()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };
	fgets(username, 30, stdin);
	memcpy(username, "abchello");
	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
}

void inputGetSWithmemcpy()
{
	int x;
	char str[100];
	scanf("%d", &x);
	fgets(str, 100, stdin);
	memcpy(str, "hello world");
	printf("x = %d, str = %s", x, str);
}

void issueMultiplememcpy()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	memcpy(c, 'a');
	fgets(c, 1, stdin);
	printf("Length:");
	scanf("%d", &size);
}

//fgets
void fgetsLimitedInput()
{
	char name[10];
	for (int i = 0; i <= 10; i++)
	{
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			printf("Your string is: , %s.\n", name);
	}
}

void flushingUnreadBuffer()
{
	char *name;
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	print(name);
}

void nonCompliantInputs(void) {
	char buf[8];
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}

void fgetsInputSplits()
{
	char buffer_input[10];

	fgets(buffer_input, 10, stdin);
	printf("You entered: %s\n", buffer_input);
}

void shortingSplittingPasswords()
{
	int x;
	char *str = "hello good day";
	int len = 10;
	fgets(str, len, stdin);
	for (x = 0; x <= len; x++)
	{
		if (str[x] == '\n')
		{
			str[x] = '\0';
			break;
		}
	}
}

void notSafeGets()
{
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafegetCopy()
{
	char *str1[15];
	fgets(str1, 14, stdin);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	str2[0] = 'A';
}

void notSafegetSMerge()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	fgets(src, 10, stdin);
	char *ps = src + 2;
	strcpy(pd, ps);
	printf(dest);
}

void resizeableGetS()
{
	char dest[100];
	fgets(dest, 15, stdin);

	char *sp = dest + 5;
	char *dp = dest + 8;

	printf(sp);
	printf(dp);
}

void changeSizeString()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	fgets(src, 20, stdin);
	strcpy(dest, src);

	printf("Final string : %s\n", dest);
}

void fgetSOverflow()
{
	char example[50];

	fgets(example, 40, stdin);

	printf("%s\n", example);
}

void fgetBuffercopy()
{
	char p[15];
	char* hw;
	int i;
	fgets(p, 10, stdin);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	print(hw);
}

void vulnerFgetsBuffer()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };
	fgets(username, 30, stdin);
	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
}

void inputGetSWithScanf()
{
	int x;
	char str[100];
	scanf("%d", &x);
	fgets(str, 100, stdin);
	printf("x = %d, str = %s", x, str);
}

void issueMultiplegetFs()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	fgets(c, 1, stdin);
	printf("Length:");
	scanf("%d", &size);
}


//sprint
{     
    char buf[8];
    sprintf(buf,"AAAA%3s","XXXXXXXX");
    printf("%s\n",buf);
}


void limitedSprintSprintf()
{
	char name[10];
	for (int i = 0; i <= 10; i++)
	{
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			sprintf("Your string is: , %s.\n", name);
	}
}

void flushingUnreadSprintf()
{
	char *name;
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	sprintf(name,stdin);
}

void nonCompliantInputsSprintf(void) {
	char buf[8];
	if (get_data(buf, sizeof(buf))) {
		sprintf("User Input: %s\n", buf);
	}
	else {
		sprintf("Error in inputting\n",15);
	}
}

void fgetsInputSplitSprintf()
{
	char buffer_input[10];

	fgets(buffer_input, 10, stdin);
	sprintf("You entered: %s\n", buffer_input);
}

void shortingSplittingPassSprintf()
{
	int x;
	char *str = "hello good day";
	int len = 10;
	fgets(str, len, stdin);
	for (x = 0; x <= len; x++)
	{
		if (str[x] == '\n')
		{
			str[x] = '\0';
			break;
		}
	}
}

void notSafeSprintf()
{
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	strcpy(dest, src);
	sprintf("Copied string: %s\n", dest);
}

void notSafegetSprintf()
{
	char *str1[15];
	fgets(str1, 14, stdin);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	str2[0] = 'A';
	sprintf(str1, 15);
}

void notSafegetSprintf()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	fgets(src, 10, stdin);
	char *ps = src + 2;
	strcpy(pd, ps);
	sprintf(dest,20);
}

void resizeableSprintf()
{
	char dest[100];
	fgets(dest, 15, stdin);

	char *sp = dest + 5;
	char *dp = dest + 8;

	sprintf(sp,20);
	sprintf(dp,20);
}

void changeSizeSprintf()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	fgets(src, 20, stdin);
	strcpy(dest, src);

	sprintf("Final string : %s\n", dest);
}

void fgetSOverflowSprintf()
{
	char example[50];

	fgets(example, 40, stdin);

	sprintf("%s\n", example);
}

void fgetBuffercopySprintf()
{
	char p[15];
	char* hw;
	int i;
	fgets(p, 10, stdin);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	sprintf(hw,30);
}

void vulnerFgetsSprintf()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };
	fgets(username, 30, stdin);
	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
	sprintf(username, 128);
}

void inputGetSWithSprintf()
{
	int x;
	char str[100];
	scanf("%d", &x);
	fgets(str, 100, stdin);
	sprintf("x = %d, str = %s", x, str);
}

void issueMultipleSprintf()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	fgets(c, 1, stdin);
	sprintf("Length:",15);
	scanf("%d", &size);
}

//gets
void getssLimitedInput()
{
	char name[10];
	for (int i = 0; i <= 10; i++)
	{
		printf("Enter any string? ");
		if (gets(name, 10, stdin) != NULL)
			printf("Your string is: , %s.\n", name);
	}
}

void flushingBufferGets()
{
	char *name;
	while (!strchr(name, '\n'))
		if (!gets(name, (sizeof name), stdin))
			break;
	print(name);
}

void nonCompliantGetss(void) {
	char buf[8];
	if (gets(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}

void getssInputSplits()
{
	char buffer_input[10];

	gets(buffer_input, 10, stdin);
	printf("You entered: %s\n", buffer_input);
}

void GetsshortingSplittingPasswords()
{
	int x;
	char *str = "hello good day";
	int len = 10;
	gets(str, len, stdin);
	for (x = 0; x <= len; x++)
	{
		if (str[x] == '\n')
		{
			str[x] = '\0';
			break;
		}
	}
}

void notSafeGetss()
{
	char src[16];
	char dest[14];
	gets(src, 15, stdin);
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafegetssCopy()
{
	char *str1[15];
	gets(str1, 14, stdin);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	str2[0] = 'A';
}

void notSafegetsSMerge()
{
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	gets(src, 10, stdin);
	char *ps = src + 2;
	strcpy(pd, ps);
	printf(dest);
}

void resizeableGetsS()
{
	char dest[100];
	gets(dest, 15, stdin);

	char *sp = dest + 5;
	char *dp = dest + 8;

	printf(sp);
	printf(dp);
}

void getsChangeSizeString()
{
	char src[40];
	char dest[100];

	memset(dest, '\0', sizeof(dest));
	gets(src, 20, stdin);
	strcpy(dest, src);

	printf("Final string : %s\n", dest);
}

void getsSOverflow()
{
	char example[50];

	gets(example, 40, stdin);

	printf("%s\n", example);
}

void getsBuffercopy()
{
	char p[15];
	char* hw;
	int i;
	gets(p, 10, stdin);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	print(hw);
}

void vulnergetssBuffer()
{
	int i;
	char username[128] = { 0 };
	char msg[2048] = { 0 };
	gets(username, 30, stdin);
	i = read(scanf, msg, sizeof(msg) - 1);
	memcpy(username, msg + 2, i - 2);
}

void inputGetsSWithScanf()
{
	int x;
	char str[100];
	scanf("%d", &x);
	gets(str, 100, stdin);
	printf("x = %d, str = %s", x, str);
}

void issueMultiplegets()
{
	char c = 'q';
	int size;

	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	gets(c, 1, stdin);
	printf("Length:");
	scanf("%d", &size);
}

int main()
{
	//strcpy
	notSafeCopy();
	notSafeDynamicCopy();
	notSafeMerging();
	notSafeDifferentSizeableString();
	notSafeDifferentSizedStrings();
	notSafeMessageOverflow();
	concatenateOverStringStrcpy();
	ignoreBufferStrcpy();
	validateBufferStrcpy();
	ignoreIndexOverflowArrysStrcpy();
	validateIndexOverflowArryStrcpy();
	strcpysLimitedInput();
	flushingAfterStrCpy();
	nonCompliantStrcpy();
	strcpyInputSplits();

	//strncpy
	safeToCopy();
	safeDynamicCopy();
	safeMerging();
	safeDifferentSizeableString();
	safeDifferentSizedStrings();
	safeMessageOverflow();
	concatenateOverStringStrncpy();
	ignoreBufferStrncpy();
	validateBufferStrncpy();
	ignoreIndexOverflowArrysStrncpy();
	validateIndexOverflowArryStrncpy();
	strncpysLimitedInput();
	flushingAfterStrnCpy();
	nonCompliantStrncpy();
	strncpyInputSplits();

	//strcat
	concatenateOverString();
	ignoreBuffer();
	validateBuffer();
	ignoreIndexOverflowArrys();
	validateIndexOverflowArrys();
	notSafeCopyStrcat();
	notSafeDynamicCopyStrcat();
	notSafeMergingStrcat();
	notSafeDifferentSizeableStringStrcat();
	notSafeDifferentSizedStringsStrcat();
	notSafeMessageOverflowStrcat();
	inputBufferStrCat();
	StrCatMultipleScanfs();
	issueUsernameMatchStrCat();
	fgetsInputStrCat();


	//scanf
	inputBuffer();
	issueMultipleScanfs();
	issueUsernameMatching();
	fgetsInputScanf();
	shortingSplittingScanf();
	notSafeGetsScanf();
	notSafegetCopyScanf();
	notSafegetSMergeScanf();
	resizeableGetScanf();
	changeSizeStringScanf();
	fgetSOverflowScanf();
	fgetBuffercopyScanf();
	vulnerFgetsBufferScanf();
	inputGetSWithScanfGets();
	issueMultipleScanf();

	//memcpy
	memcpyBufferCopy();
	vulnerBufferMemcpy();
	nonCompliantmemcpy();
	fgetsInputmemcpy();
	shortingSplittingmemcpy();
	notSafememcpy();
	notSafegetmemcpy();
	notSafegetmemcpy();
	resizeablememcpy();
	changeSizememcpy();
	fgetSOverflowmemcpy();
	fgetBuffermemcpy();
	vulnerFgetsmemcpy();
	inputGetSWithmemcpy();
	issueMultiplememcpy();

	//fgets
	fgetsLimitedInput();
	flushingUnreadBuffer();
	nonCompliantInputs();
	fgetsInputSplits();
	shortingSplittingPasswords();
	notSafeGets();
	notSafegetCopy();
	notSafegetSMerge();
	resizeableGetS();
	changeSizeString();
	fgetSOverflow();
	fgetBuffercopy();
	vulnerFgetsBuffer();
	inputGetSWithScanf();
	issueMultiplegetFs();

	//sprintf
	limitedSprintSprintf();
	flushingUnreadSprintf();
	nonCompliantInputsSprintf();
	fgetsInputSplitSprintf();
	shortingSplittingPassSprintf();
	notSafeSprintf();
	notSafegetSprintf();
	notSafegetSprintf();
	resizeableSprintf();
	changeSizeSprintf();
	fgetSOverflowSprintf();
	fgetBuffercopySprintf();
	vulnerFgetsSprintf();
	inputGetSWithSprintf();
	issueMultipleSprintf();

	//gets
	getssLimitedInput();
	flushingBufferGets();
	nonCompliantGetss();
	getssInputSplits();
	GetsshortingSplittingPasswords();
	notSafeGetss();
	notSafegetssCopy();
	notSafegetsSMerge();
	resizeableGetsS();
	getsChangeSizeString();
	getsSOverflow();
	getsBuffercopy();
	vulnergetssBuffer();
	inputGetsSWithScanf();
	issueMultiplegets();

	return 0;
}
