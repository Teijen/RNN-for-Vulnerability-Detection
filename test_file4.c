#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>

void notSafeCopy(char* src);
void notSafeDynamicCopy(char* s);
void notSafeMerging(char* s);
void notSafeDifferentSizeableString(char* s);
void notSafeDifferentSizedStrings(char* s);
void notSafeMessageOverflow(char* s);
void concatenateOverStringStrcpy(char* s);
void ignoreBufferStrcpy(char* s);
int validateBufferStrcpy(char* message);
void ignoreIndexOverflowArrysStrcpy();
void validateIndexOverflowArryStrcpy(int n, char* s);
void strcpysLimitedInput();
void flushingAfterStrCpy(char* s);
int nonCompliantStrcpy(char* s);
void strcpyInputSplits(char* s, char* t);
void notSafeToCopy(char* s, int n);
void notSafeDynamicCopyStrncpy();
void notSafeMergingStrncpy();
void notSafeDifferentSizeableStringStrncpy(char* s);
void notSafeDifferentSizedStringsStrncpy(char*s, int n);
void notSafeMessageOverflowStrncpy(char* s, int n);
void concatenateOverStringStrncpy(char* s);
void ignoreBufferStrncpy(int n);
void validateBufferStrncpy(int n);
void ignoreIndexOverflowArrysStrncpy();
void validateIndexOverflowArryStrncpy();
void strncpysLimitedInput(int n);
void flushingAfterStrnCpy();
void nonCompliantStrncpy(int n);
void strncpyInputSplits();
void concatenateOverString(char* s, char* t); 
void ignoreBuffer(char* s);
void validateBuffer(char* s);
void ignoreIndexOverflowArrys(char* s);
void validateIndexOverflowArrys(char* s);
void notSafeCopyStrcat();
void notSafeDynamicCopyStrcat(char* s, int n);
void notSafeMergingStrcat(char* s);
void notSafeDifferentSizeableStringStrcat(char* s);
void notSafeDifferentSizedStringsStrcat(char* s);
void notSafeMessageOverflowStrcat(char* s);
void inputBufferStrCat();
void StrCatMultipleScanfs(char* s);
void issueUsernameMatchStrCat();
void inputStrCat(char* s);
void inputBuffer();
void issueMultipleScanfs();
void issueUsernameMatchScanf();
void scanfInput();
void shortingSplittingScanf();
void notSafeGetsScanf();
void notSafegetCopyScanf(int n);
void notSafegetSMergeScanf(char* s);
void resizeableGetScanf(char* s);
void changeSizeStringScanf();
void overflowScanf();
void buffercopyScanf();
void vulnerableBufferScanf();
void inputWithScan();
void twoIssueMultipleScanf();
void smallSprintf(char* s);
void limitedSprintSprintf(char* s);
void flushingUnreadSprintf(char* s);
void dynamicSprintf(int a, int b, char* s);
void tooLongStringSpritf();
void notSafeSprintf(char* s);
void notSafegetSprintf(char* s);
void notSafeSprintfMul(char* s, char* t);
void notSafegetSprintfTwo(int n);
void overflowSprintfWithArray();
void overflowSprintfWithArrayTwo(char* s);
void overflowSprintfWithArrayThree(int a);
void inputGetSWithSprintf(char* s);
void outputWithSprintf();
int outputWithSprintfArgs(int a, int b, char* s);
void getsDefinedBuff();
void getsDynamicBuff();
void getsArgSizeParam(int n);
void getsAargSizeAndArg(int n);
void getsDefinedBuffWithAdd();
void getsDefinedBuffWithAddPrint();
void getsWithMemset();
int getsWithMalloc();
void safeFgetsUnsafeGets();
void safeFgetsUnsafeGetsTwo();
void getsIfstatements();
void getsForLoop();
void getsForLoopWithArg(char* s);
void getsifstatementsTwo(char* s1, char* s2);
char* getsReturnToMain();
void fgetsSmallBuffer();
void fgetsSmallBufferWithArg(char* s);
void fgetsConstantTooLong();
void fgetsWithArgLength(int n);
void fgetsWithDynamicSize();
void getsWithStringArg(char* s);
char* fgetsWithReturnAndSmallArray();
int fgetsWithMalloc();
void fgetsPlaceInArray();
int fgetsThreeFgets();
void fgetsWrongSizeUse();
void fgetsWithArithmetic();
void writeToWrongArraySize();
void fgetsWithSafeStrCpy();
void fgetsWithIf();
void memcpySmallIntoLarge(char* s);
void memcpySmallIntoLargeTwo(char* s);
void memcpySafeFgets(char* s);
void memcpySmallBufferDynamic(char* s);
void memcpyWithArithmetic();
void memcpyWithIf();
void memcpyWithArgs(int n);
void memcpyForLoopPrint(char* s);
void memcpyPlaceInArray();
void memcpyWithTwoArgs(int n, char* s);
void memcpyWith2DArray(char* s);
void memcpyWithPuts(char* s);
void memcpyFunPointers(char* s);
int memcpyMalloc();
void memcpyTwoStringArgs(char* s, char* t);

int main(int argc, char* argv[]){
	notSafeCopy(argv[1]); 
	notSafeDynamicCopy(argv[1]);
	notSafeMerging(argv[1]);
	notSafeDifferentSizeableString(argv[1]);
	notSafeDifferentSizedStrings(argv[1]);
	notSafeMessageOverflow(argv[1]);
	concatenateOverStringStrcpy(argv[1]);
	ignoreBufferStrcpy(argv[1]);
	validateBufferStrcpy(argv[1]);
	ignoreIndexOverflowArrysStrcpy();
	validateIndexOverflowArryStrcpy(strtol(argv[1], NULL, 10), argv[2]);
	strcpysLimitedInput();
	flushingAfterStrCpy(argv[1]);
	nonCompliantStrcpy(argv[1]);
	strcpyInputSplits(argv[1], argv[2]);
	notSafeToCopy(argv[1], strtol(argv[2], NULL, 10));
	notSafeDynamicCopyStrncpy();
	notSafeMergingStrncpy();
	notSafeDifferentSizeableStringStrncpy(argv[1]);
	notSafeDifferentSizedStringsStrncpy(argv[1], strtol(argv[2], NULL, 10));
	notSafeMessageOverflowStrncpy(argv[1], strtol(argv[2], NULL, 10));
	concatenateOverStringStrncpy(argv[1]);
	ignoreBufferStrncpy(strtol(argv[1], NULL, 10));
	validateBufferStrncpy(strtol(argv[1], NULL, 10));
	ignoreIndexOverflowArrysStrncpy();
	validateIndexOverflowArryStrncpy();
	strncpysLimitedInput(strtol(argv[1], NULL, 10));
	flushingAfterStrnCpy();
	nonCompliantStrncpy(strtol(argv[1], NULL, 10));
	strncpyInputSplits();
	concatenateOverString(argv[1], argv[2]);
	ignoreBuffer(argv[1]);
	validateBuffer(argv[1]);
	ignoreIndexOverflowArrys(argv[1]);
	validateIndexOverflowArrys(argv[1]);
	notSafeCopyStrcat();
	notSafeDynamicCopyStrcat(argv[1], strtol(argv[2], NULL, 10));
	notSafeMergingStrcat(argv[1]);
	notSafeDifferentSizeableStringStrcat(argv[1]);
	notSafeDifferentSizedStringsStrcat(argv[1]);
	notSafeMessageOverflowStrcat(argv[1]);
	inputBufferStrCat();
	StrCatMultipleScanfs(argv[1]);
	issueUsernameMatchStrCat();
	inputStrCat(argv[1]);
	inputBuffer();
	issueMultipleScanfs();
	issueUsernameMatchScanf();
	scanfInput();
	shortingSplittingScanf();
	notSafeGetsScanf();
	notSafegetCopyScanf(strtol(argv[1], NULL, 10));
	notSafegetSMergeScanf(argv[1]);
	resizeableGetScanf(argv[1]);
	changeSizeStringScanf();
	overflowScanf();
	buffercopyScanf();
	vulnerableBufferScanf();
	inputWithScan();
	twoIssueMultipleScanf();
	smallSprintf(argv[1]);
	limitedSprintSprintf(argv[1]);
	flushingUnreadSprintf(argv[1]);
	dynamicSprintf(strtol(argv[1], NULL, 10),strtol( argv[2], NULL, 10), argv[3]);
	tooLongStringSpritf();
	notSafeSprintf(argv[1]);
	notSafegetSprintf(argv[1]);
	notSafeSprintfMul(argv[1], argv[2]);
	notSafegetSprintfTwo(strtol(argv[1], NULL, 10));
	overflowSprintfWithArray();
	overflowSprintfWithArrayTwo(argv[1]);
	overflowSprintfWithArrayThree(strtol(argv[1], NULL, 10));
	inputGetSWithSprintf(argv[1]);
	outputWithSprintf(argv[1]);
	outputWithSprintfArgs(strtol(argv[1], NULL, 10),strtol( argv[2], NULL, 10), argv[3]);
    getsDefinedBuff();
    getsDynamicBuff();
    getsArgSizeParam(strtol(argv[1], NULL, 10));
    getsAargSizeAndArg(strtol(argv[1], NULL, 10));
	getsDefinedBuffWithAdd();
    getsDefinedBuffWithAddPrint();
    getsWithMemset();
    getsWithMalloc();
    safeFgetsUnsafeGets();
    safeFgetsUnsafeGetsTwo();
    getsIfstatements();
    getsForLoop();
    getsForLoopWithArg(argv[1]);
    getsifstatementsTwo(argv[1],argv[2]);
    char* string = getsReturnToMain();
    fgetsSmallBuffer();
    fgetsSmallBufferWithArg(argv[1]);
    fgetsConstantTooLong();
    fgetsWithArgLength(strtol(argv[1], NULL, 10));
    fgetsWithDynamicSize();
    fgetsWithStringArgi(argv[1]);
    char* someInput = fgetsWithReturnAndSmallArray();
    fgetsWithMalloc();
    fgetsPlaceInArray();
    fgetsThreeFgets();
    fgetsWrongSizeUse();
    fgetsWithArithmetic();
    fgetsWithSafeStrCpy();
    writeToWrongArraySize();
    fgetsWithIf();
    memcpySmallIntoLarge(argv[1]);
    memcpySmallIntoLargeTwo(argv[1]);
    memcpySafeFgets(argv[1]);    
    memcpySmallBufferDynamic(argv[1]);
    memcpyWithArithmetic();
    memcpyWithIf();
    memcpyWithArgs(strtol(argv[1], NULL,10));
    memcpyForLoopPrint(argv[1]); 
    memcpyPlaceInArray();
    memcpyWithTwoArgs(strtol(argv[1], NULL, 10), argv[2]);
    memcpyWith2DArray(argv[1]);
    memcpyWithPuts(argv[1]);
    memcpyFunPointers(argv[1]);
    memcpyMalloc();
    memcpyTwoStringArgs(argv[1], argv[2]); 
    return 0;
}
void notSafeCopy(char* src){
	char dest[14];
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafeDynamicCopy(char* src){
	char *str2 = malloc(10);
	strcpy(str2, src); 
    printf("%s\n", str2);
	free(str2);
}

void notSafeMerging(char* s){
	char dest[15] = "Testing second";
	printf("Before: %s", dest);
	strcpy(dest, s);
	printf("After: %s", dest);
}

void notSafeDifferentSizeableString(char* s){
	char dest[20];
	dest[0] = 'A';
	dest[1] = 'B';
	dest[2] = 'C';
	strcpy(dest, s);
}

void notSafeDifferentSizedStrings(char* s){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	strcpy(src, "This is somesiteilike.com");
	strcpy(dest, src);
	strcpy(dest, s);
	printf("Final copied string : %s\n", dest);
}

void notSafeMessageOverflow(char* s){
	char example[50];
	memset(example, '\0', sizeof(example));
	strcpy(example, s);
	printf("%s\n", example);
}

void concatenateOverStringStrcpy(char* s){
	char* str1;
	char* str2;
	str1 = strdup("String");
    str2 = strdup("test");
    printf("%s\n", str1);
    printf("%s\n", str2);
	char dest[strlen(str1) + strlen(str2)];
	strcpy(dest, s);
}

void ignoreBufferStrcpy(char* s) {
	char *greeting = "Hello mr./ms: ";
	char buf[80];
	strcat(buf, greeting);
	strcpy(&buf[10], s);
	printf("%s\n", buf);
}

int validateBufferStrcpy(char* s) {
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 120){
		strcpy(buf, s);
        printf("%s\n",buf);
        return 0;
    }
    return 0;
}

void ignoreIndexOverflowArrysStrcpy(){
	char dest[100];
	char tmp[70];
	fgets(tmp,70, stdin);
	strcpy(&dest[0], tmp);
	printf("dest : %s\n", dest);
	fgets(tmp,70, stdin);
	strcpy(&dest[70], tmp);
	printf("dest : %s\n", dest);
}

void validateIndexOverflowArryStrcpy(int n, char* s){
	char dest[n];
	strcpy(dest, s);
	printf("dest : %s\n", dest);
}

void strcpysLimitedInput(){
	char name[50];
	char name2[10];
	for (int i = 0; i <= 2; i++){
		printf("Enter any string? ");
		if (fgets(name, 49, stdin) != NULL)
			printf("Your string is: %s\n", name);

	}
	strcpy(name2, name);
    printf("Final string %s\n",name2);
}

void flushingAfterStrCpy(char* s){
    // Might need to remove fgets
   	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%50;
	int c = rand()%50;
	printf("%d, %d, %d\n",a,b,c);
	char dest[a];
	strcpy(dest, s);
	printf("%s\n", s);
}

int nonCompliantStrcpy(char* s) {
   	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%50;
	int c = rand()%50;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char dest[50];
	strcpy(dest, s);
	printf("%s\n", s);
}

void strcpyInputSplits(char* s, char* t){
	char fin[strlen(s) + strlen(t)];
	char dest[strlen(s)];
	printf("%d, %d\n", sizeof(fin), sizeof(dest));
	strcat(fin,s);
	strcat(fin,t);
	strcpy(dest,fin);
	printf("%s\n", dest);
}

void notSafeToCopy(char*s, int n){
	char dest[n];
	strncpy(dest, s, strlen(s));
	printf("Copied string: %s\n", dest);
}

void notSafeDynamicCopyStrncpy(){
	int n; 
	char tmp[256];
	printf("Enter size of string:\n");
	scanf("%d", &n);
	while((n= getchar()) != '\n' && n != EOF);
	char dest[n];
	printf("Enter string to store:\n");
	fgets(tmp, 256, stdin);
	strncpy(dest, tmp, strlen(tmp));
	printf("%s\n",dest);
}

void notSafeMergingStrncpy(){
	char* greeting = "Hello mr/ms:       ";
	char tmp[40];
	char fin[40];
	strcat(fin, greeting);
	printf("Enter your full name: \n");
	fgets(tmp, sizeof(tmp), stdin);
	strncpy(&fin[strlen(greeting)],tmp,strlen(tmp));
	printf("%s\n", fin);
}

void notSafeDifferentSizeableStringStrncpy(char*s ){
	char* greeting = "Hello mr/ms:       ";
	char fin[40];
	strcat(fin, greeting);
	strncpy(&fin[strlen(greeting)],s,strlen(s));
	printf("%s\n", fin);
}

void notSafeDifferentSizedStringsStrncpy(char* s, int n){
	int x, y, z;
	x = n+n;
	y = n-n;
	z = n*n;
	char dest[n];
	strncpy(dest, s, strlen(s));
	printf("Copied string: %s\n", dest);
}


void notSafeMessageOverflowStrncpy(char*s, int n){
	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%50;
	int c = rand()%50;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char dest[n];
	strncpy(dest, s, strlen(s));
	printf("Copied string: %s\n", dest);
}

void concatenateOverStringStrncpy(char* s){
	char tmp[strlen(s)];
	char dest[50];
	printf("%d vs %d\n", sizeof(tmp), sizeof(dest));
	strncpy(tmp, s, strlen(s));
	tmp[0] = 'A';
	tmp[1] = 'B';
	tmp[2] = 'C';
	strncpy(dest, tmp, strlen(s));
	printf("Copied string: %s\n", dest);
}

void ignoreBufferStrncpy(int n) {
	char tmp[256]; 
	char dest[(int)n];
	printf("Enter your full name: \n");
	fgets(tmp, 256, stdin);
	tmp[0] = 'A';
	tmp[1] = 'B';
	tmp[2] = 'C';
	strncpy(dest, tmp, strlen(tmp));
	printf("Copied string: %s\n", dest);
}

void validateBufferStrncpy(int n) {
	char tmp[256]; 
	char* dest = malloc(sizeof(char)*n);
	printf("%d\n", sizeof(dest));
	printf("Enter your full name: \n");
	fgets(tmp, 256, stdin);
	tmp[0] = 'A';
	tmp[1] = 'B';
	tmp[2] = 'C';
	strncpy(dest, tmp, strlen(tmp));
	printf("Copied string: %s\n", dest);
	free(dest);
}

void ignoreIndexOverflowArrysStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "string", "any" };
	int t;
	srand((unsigned) time(&t));
	int a = rand()%5;
	strncpy(sentence, article[a], 10);
	printf("%s\n", sentence);
	fgets(sentence, 256, stdin);
}

void validateIndexOverflowArryStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "string", "any" };
	int t;
	srand((unsigned) time(&t));
	int a = rand()%5;
	if (a >= 0 && a <= 4){
		strncpy(sentence, article[a], 10);
		printf("%s\n", sentence);
	}
	fgets(sentence, 256, stdin);
}

void strncpysLimitedInput(int n){
	char name[50];
	char name2[n];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 50, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strncpy(name2, name, 100);
    printf("%s\n",name2);
}

void flushingAfterStrnCpy(){
	char name[200] = " ";
    char t [1] = "hello";
	strncpy(name, t, sizeof(t));
    printf("hello\n\n");
	while (!strchr(name, '\n'))
		if (!fgets(name, 200, stdin))
			break;
	strncpy(t, name, strlen(name));
	printf("final %s\n", t);
}

void nonCompliantStrncpy(int n) {
	int ix = n*n;
	printf("%d\n", n);
	if(ix>=100){
		printf("Input larger or equal to 10\n");
	}else{
		printf("Input less than 10\n");
	}
	char buff[10];
	char tmp[ix];
	fgets(tmp, 100, stdin);
	strncpy(buff,tmp, strlen(tmp));
}


void strncpyInputSplits(){
	int n = 0;
	char fin[5];
	printf("What is the size you want to allocate?\n");
	scanf("%d", &n);
	while((n= getchar()) != '\n' && n != EOF);
	printf("Enter the string you want to store:\n");
	char buff[n];
	fgets(buff, n, stdin);
	for(int i = 0; i < strlen(buff); i++){
		printf("%c", buff[i]);
	}
	printf("\n");
	strncpy(fin, buff, strlen(buff));
	printf("final string %s\n", fin);


}

void concatenateOverString(char* s, char* t){
	char tmp[strlen(s)+strlen(t)];
	char dest[20];
	strcat(tmp, s);
	strcat(tmp,t);
	strcat(dest, tmp);
	printf("New String : %s\n",dest); 
}

void ignoreBuffer(char* s) {
	char* greeting = "Hello mr/ms:       ";
	char fin[40];
	strcat(fin, greeting);
	strcat(fin,s);
}

void validateBuffer(char* s) {
	char* greeting = "Hello mr/ms:       ";
	int t;
	srand((unsigned) time(&t));
	int a = rand()%40;
	int b = rand()%30;
	int c = rand()%20;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char fin[40];
	strcat(fin, greeting);
	strcat(fin,s);

}

void ignoreIndexOverflowArrys(char* s){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some", "any" };
	int val = rand() % 4;
	strcat(sentence, article[val]);
	strcat(sentence, s);
}

void validateIndexOverflowArrys(char* s){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some ", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strcat(sentence, article[val]);
		strcat(sentence, s);
	}
}

void notSafeCopyStrcat(){
	char* src = "Testing input string, what happened";
	char dest[14];
	strcat(dest, src);
	char tmp[256];
	fgets(tmp, 256, stdin);
	strcat(dest, tmp);
	printf("Copied string: %s\n", dest);
}

void notSafeDynamicCopyStrcat(char* s, int n){
	int x = n*n;
	int y = n+n;
	int z = 2*n/3;
	char dest[y];
	strcat(dest, s);
	printf("%s final \n",dest);
}

void notSafeMergingStrcat(char* s){
	int n; 
	char dest[50];
	printf("What is the size you want to allocate?\n");
	scanf("%d", &n);
	printf("Got number: %d\n", n);
	strcat(dest,s);
}

void notSafeDifferentSizeableStringStrcat(char* s){
	char* first = "First";
	char* second = "Second";
	char* third = "Third";
	char dest[strlen(first)+strlen(second)+strlen(third)*2];
	strcat(dest, first);
	strcat(dest, second);
	strcat(dest, third);
	strcat(dest, s);
}

void notSafeDifferentSizedStringsStrcat(char* s){
	char src[sizeof(char)*40];
	char dest[sizeof(char)*50];
	memset(src, '\0', sizeof(src));
	memset(dest, '\0', sizeof(dest));
	strcat(src, "This is aNiceWebSite.com which I like");
	strcat(dest, src);
	strcat(dest, s);
}

void notSafeMessageOverflowStrcat(char* s){
	char example[50];
	strcat(example, "Hello mr. ms: ");
	strcat(example, s);
}

void inputBufferStrCat(){
	char x[sizeof(char)*10];
	char str[sizeof(char)*100];
	strcat(x,"hello world");
	fgets(str, sizeof(char)*90, stdin);
	strcat(x,str);
	printf(" str = %s\n", x);
}

void StrCatMultipleScanfs(char* t){
	char s[strlen(t)];
	strncpy(s, t, strlen(t));
	printf("%c\n", s[0]);
	s[0] = 'A';
	s[1] = 'B';
	s[2] = 'C';
	s[3] = '1';
	s[4] = '2';
	s[5] = '3';
	char c[10];
	strcat(c,s);
}

void issueUsernameMatchStrCat(){
	char username[20];
	char result[25];
	printf("Enter your name: ");
	fgets(username, 20, stdin);
	strcat(result,"Welcome to the program, ");
	strcat(result, username);
	printf("%s\n", result);
}

void inputStrCat(char *s){
	char test [20] = "This is a test string";
	for(int i = 0; i < strlen(test); i++){
		memset(&test[i], 'A', 1);
	}
	printf("%s\n", test);
	strcat(test,s); 
}

void inputBuffer(){
	char str[100];
	scanf("%s", str);
	printf("x = %d, str = %s\n", str, str);
}

void issueMultipleScanfs(){
	int size;
	printf("Enter size of input ");
	scanf("%d", &size);
	char dest[size];
	printf("Enter string input ");
	scanf("%s", dest);
	printf("final: %s\n", dest);
}

void issueUsernameMatchScanf(){
	char greeting[20] = "Hello, mr./ms";
	char final[40];
	strcat(final, greeting);
	printf("Enter your name: ");
	scanf("%s", &final[20]);
	printf("%s\n",final);
}

void scanfInput(){
	int a = 4;
	int b = 7;
	int c = a+b;
	printf("%d Total: \n",c);
	char buffer_input[10];
	scanf("%s", buffer_input);
	printf("You entered: %s\n", buffer_input);
}

void shortingSplittingScanf(){
	int x;
	char str[12] = "hello good day";
	int len = 10;
	scanf("%s", str);
	for (x = 0; x <= len; x++){
		if (str[x] == '\n'){
			str[x] = '\0';
			break;
		}
	}
	printf("You entered: %s\n", str);
}

void notSafeGetsScanf(){
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	scanf("%s", src);
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

void notSafegetCopyScanf(int n){
	printf("Your total size available: %d\n", n);
	char str1[n];
	scanf("%s", str1);
}

void notSafegetSMergeScanf(char* s){
	char final[strlen(s)];
	for(int i =0; i < strlen(s); i++){
		printf("%c", s[i]);
	}
	printf("\n");
	scanf("%s", final);
	printf("Final string: %s",final);
}

void resizeableGetScanf(char* t){
	char s[strlen(t)];
	strncpy(s, t, strlen(t));
	s[0] = 'A';
	s[1] = 'B';
	s[2] = 'C';
	s[3] = '1';
	s[4] = '2';
	s[5] = '3';
	scanf("%s", s);
}

void changeSizeStringScanf(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	scanf("%s", src);
	strcpy(dest, src);
	printf("Final string : %s\n", dest);
}

void overflowScanf(){
	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%70;
	int c = rand()%10;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char example[f];
	scanf("%s", example);
	printf("%s\n", example);
}

void buffercopyScanf(){
	char p[15];
	char* hw;
	int i;
	scanf("%s", &p);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	printf("%s\n",hw);
}

void vulnerableBufferScanf(){
	int i;
	char username[128] = { 0 };
	printf("%s\n",username);
	char msg[2048] = { 0 };
	scanf("%s", username);
	i = read(scanf, msg, sizeof(msg) - 1);
}

void inputWithScan(){
	int x;
	char str[100];
	printf("Enter any number \n");
	scanf("%d", &x);
	printf("Enter any String \n");
	scanf("%s", &str);
	printf("number = %d, string = %s\n", x, str);
}

void twoIssueMultipleScanf(){
	int x;
	printf("Enter any number \n");
	scanf("%d", &x);
	if(x > 10){
		printf("You entered larger than 10\n");
		char buff[2048];
		scanf("%s", buff);
		printf("You entered :%s", buff);
	}else{
		printf("You entered less than 10\n");
		char buff[x];
		scanf("%s", buff);
		printf("You entered :%s", buff);

	}
}

void smallSprintf(char* s){
	char buf[20];
    sprintf(buf,"You entered: %s",s);
    printf("%s\n",buf);
}

void limitedSprintSprintf(char* s ){
	char number[5];
	int sum;
	printf("Enter any number\n");
	fgets(number, sizeof(number),stdin);
	sum = atoi(number);
	char dest[sum];
	char tmp[100];
	sprintf(tmp, "Final string %s", s);
	printf("%s\n", tmp);
}

void flushingUnreadSprintf(char* s){
	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%70;
	int c = rand()%10;
	int d = a+b+c;
	int e = a-b-c;
	int f = a+b-c;
	char dest[100]; 
	sprintf(dest,"%s",s);
	printf("%s\n", dest);
}

void dynamicSprintf(int a, int b, char*s){
	int c = (a * b); 
	char dest[c];
	sprintf(dest, "%s", s);
	printf(dest);
}

void tooLongStringSpritf(){
	char buf[20] = "Greetings mr. /ms:";
	char name[40];
	char dest[40]; 
	printf("Enter your name :\n");
	fgets(name,40,stdin );
	sprintf(dest,"final: %s %s",buf,  name);
	printf("%s\n", dest);
}

void notSafeSprintf(char* s){
	char buf[20] = "Greetings mr. /ms:";
	char dest[40]; 
	sprintf(dest,"final: %s %s",buf,  s);
	printf("%s\n", dest);
}

void notSafegetSprintf(char *s){
	printf("Your string:");
	for(int i =0; i < strlen(s); i++){
		printf("%c", s[i]);
	}
	printf("\n");
	char dest[40];
	sprintf(dest,"%s", s);
}

void notSafeSprintfMul(char* s, char* t){
	char final[strlen(s)];
	char temp[strlen(s)+strlen(t)];
	strcat(temp, s);
	strcat(temp, t);
	sprintf(final, " str : %s", temp);
	printf("%s\n", final);
}

void notSafegetSprintfTwo(int n){
	char buf[50];
	if(n>10){
		printf("Number greater than 10\n");
		fgets(buf, 50, stdin);
	}else{
		printf("Number less than or equal to 10\n");
		fgets(buf, 50, stdin);
	}
	char final[n];
	sprintf(final,"%s",buf);
}

void overflowSprintfWithArray(){
	char example[5];
	example[0] = "A";
	example[1] = "B";
	example[2] = "C";
	char dest[100];
	fgets(dest, 100, stdin);
	sprintf(example,"Final string: %s\n", dest);
	printf("%s\n", example);
}


void overflowSprintfWithArrayTwo(char* s){
	char example[5];
	example[0] = "A";
	example[1] = "B";
	example[2] = "C";
	sprintf(example,"%s\n", s);
	printf("final : %s\n", example);
}

void overflowSprintfWithArrayThree(int a){
	char example[50];
	example[5] = "A";
	example[6] = "B";
	example[10] = "C";
	char rev[a];
	printf("%d, %d\n", sizeof(example), sizeof(rev));
	fgets(rev, a, stdin);
	sprintf(example,"%s\n", rev);
	printf("final : %s\n", example);
}

void inputGetSWithSprintf(char* s){
	char str[100];
	char final[10];
	memset(final, '\0', sizeof(final));
	printf("Available size for input %d\n", sizeof(final));
	fgets(str, 100, stdin);
	sprintf(final, "Your input: %s, your arg %s\n",final,  s);
	printf("%s\n", final);
}

void outputWithSprintf(char* s){
	puts("hello");
	puts("theese ");
	puts("are ");
	puts("just");
	puts("strings");
	char final[20];
	sprintf(final, "%s", s);
	printf("%s",final);

}

int outputWithSprintfArgs(int a, int b, char* s){
	int c = (a*b);
	int d = (a-b);
	int e = (a+b);
	printf("%d\n",a);
	printf("%d\n",b);
	printf("%d\n",c);
	printf("%d\n",d);
	printf("%d\n",e);
	char output[40];
	sprintf(output, "%s", s);
	printf("%s\n",output);
	return 0;
}

void getsDefinedBuff(){
    char buff[20];
    printf("Enter your name:\n");
    gets(buff);
    printf("Hello: %s\n", buff);
}

void getsDynamicBuff(){
    int size;
    printf("Enter size of input:\n");
    scanf("%d",&size);
    while((size= getchar()) != '\n' && size != EOF);
    char buff[size];
    printf("Enter input:\n");
    gets(buff);
}

void getsArgSizeParam(int n){
    char buff[n];
    gets(buff);
}

void getsAargSizeAndArg(int n){
    char final[20 + n];
    char* s = "This is the buffer";
    char buff[20];
    strncpy(final, buff, 20);
    gets(final);
    printf("%s", buff);
}

void getsDefinedBuffWithAdd(){
    int a,b,c = 2;
    int d = (a+b+c);
    int e = a*b*c;
    int f = a+b/c;
    char buff[20];
    printf("Enter your name:\n");
    gets(buff);
    printf("Hello: %s\n", buff);
}

void getsDefinedBuffWithAddPrint(){
    int a = 4;
    int b = 3;
    int c = -2;
    int d = (a+b+c);
    int e = a*b*c;
    int f = a+(b/c);
    printf("These are the numbers: %d, %d, %d\n",d,e,f);
    char buff[20];
    printf("Enter your name:\n");
    gets(buff);
    printf("Hello: s%", buff);
}

void getsWithMemset(){
    char dest[10];
    memset(dest, '\0', sizeof(dest));
    gets(dest);
}

int getsWithMalloc(){
    int size, width, x;
    printf("Enter two numbers to add :\n");
    scanf("%d%d",&size, &width);
    while((width= getchar()) != '\n' && width != EOF);
	x = size + width;
    printf("Sum of the two: %d\n", x);
    char buff[20]; 
    printf("Enter short feedback: \n");
    gets(buff);
    return 0;
}

void safeFgetsUnsafeGets(){
    char line[256];
    int i;
	fgets(line, 256, stdin);
    gets(line);
}

void safeFgetsUnsafeGetsTwo(){
    char line[50];
    int i;
	fgets(line, 50, stdin);
    line[20] = 'x';
    line[30] = 'x';
    line[42] = 'x';
    printf("%s\n",line);
    gets(line);
}

void getsIfstatements(){
    int i;
    int final;
    printf("Write a number\n");
    scanf("%d",&i);
    while((i= getchar()) != '\n' && i != EOF);
    if(i > 10){
        printf("Number larger than 10\n");
        final = i;
    }else{
        printf("Number less or equal to 10\n");
        final = (i*2);
    }
    char buff[final];
    gets(buff);
}

void getsForLoop(){
    char* c = "Hello";
    for(int i = 0; i < strlen(c); i++){
        printf("%c",c[i]);
    }
    printf("\n");
    char buff[strlen(c)];
    gets(buff);

}

void getsForLoopWithArg(char* s){
    for(int i = 0; i < strlen(s); i++){
        printf("%c",s[i]);
    }
    printf("\n");
    char buff[strlen(s)];
    gets(buff);
}

void getsifstatementsTwo(char* s1, char* s2){
    char buff[strlen(s1) + strlen(s2)];
    while(buff[strlen(buff)] != '/0'){
        gets(buff);
        printf("Echo: %s\n", buff);
    }
}

char* getsReturnToMain(){
    printf("How long is your input?:\n");
    int n = scanf("%d", &n);
    while((n = getchar()) != '\n' && n != EOF);
    char buffer[n];
    printf("Enter the input you want to save:\n");
    gets(buffer);
    return buffer;
}

void fgetsSmallBuffer(){
    char str[2];
    fgets(str,10,stdin);
    printf("%d and %s\n",sizeof(str), str);
}

void fgetsSmallBufferWithArg(char* s){
    printf("Argument string: %s\n",s);
    char str[50];
    fgets(str, strlen(s), stdin);
    printf("Written string: %s\n",str);
}

void fgetsConstantTooLong(){
    const int DATA_SIZE = 64;
    char buffer[24];
    printf("Write your username: \n");
    fgets(buffer, DATA_SIZE, stdin);
    printf("Hello, %s",buffer);
}

void fgetsWithArgLength(int n){
    char buffer[n];
    printf("Total bytes available %d\n", sizeof(buffer));
    printf("Enter your input\n");
    fgets(buffer, &n, stdin);
}

void fgetsWithDynamicSize(){
    int size; 
    printf("Enter size of input\n"); 
    scanf("%d",&size);
    while((size= getchar()) != '\n' && size != EOF);
    char buffer[size];
    fgets(buffer, &size, stdin);
}

void fgetsWithStringArgi(char* s){
    int i;
    for(i = 0; i < strlen(s); i++){
        printf("%c\n",s[i]);
    }
    char in[i];
	printf("%d\n", sizeof(in));
    fgets(in, i*i, stdin);
}

char* fgetsWithReturnAndSmallArray(){
    char* inn[10];
    printf("%d\n",sizeof(int));
    fgets(inn,sizeof(int)*sizeof(inn),stdin);
    return inn; 
}

int fgetsWithMalloc(){
    int size, width; 
    printf("Enter two numbers to add :\n");
    scanf("%d%d",&size, &width);
    while((size= getchar()) != '\n' && size != EOF);
	printf("Total of the two :%d\n", size+width);
    char string[50];
	printf("%d mul: /n", size*width);
    fgets(string, size*width, stdin);
	printf("%s\n", string);
    return 0; 
}

void fgetsPlaceInArray(){
    char test[20];
    printf("%d\n", sizeof(test));
    memset(test, 'a', sizeof(test));
    printf("%s\n",test);
    fgets(test, 20, stdin);
    fgets(&test[15], 20, stdin);
    printf("%s\n",test);
}

int fgetsThreeFgets(){
    int j, k = 10;
    int i = 0;
    char writes[k];
    scanf("%d",&i);
    fgets(writes, i,stdin);
    fgets(writes, k,stdin);
    fgets(writes, j, stdin);
    return 0;
}

void fgetsWrongSizeUse(){
    char  write_to_me[50];
    int *x = 50;
    printf("Write a string, limit 50 chars\n");
    printf("%d\n", &x);
    fgets(write_to_me, &x, stdin);
}

void fgetsWithArithmetic(){
    int a = 4;
    int b = -5;
    int c = 2;
    int d = a+b+c;
    int e = a-b-c;
    int f = a/b*c;
    int g = a*b/c;
    printf("%d, %d, %d, %d\n", d, e, f, g);
    char bu[15];
    fgets(bu,35, stdin);
    printf("%s\n", bu);
}

void fgetsWithSafeStrCpy(){
    char dest [100];
    char tmp [50];
    fgets(tmp, sizeof(tmp), stdin);
    strcpy(dest, tmp);
    fgets(&dest[strlen(tmp)],sizeof(dest),stdin);
}

void writeToWrongArraySize(){
    char tmp[50];
    char dest[100];
    fgets(tmp, sizeof(tmp), stdin);
    strcpy(dest, tmp);
    fgets(tmp, sizeof(dest), stdin);
    strcpy(dest,tmp);
}

void fgetsWithIf(){
    int ix;
    int final;
    printf("How many bytes do you want to store?\n");
    scanf("%d",&ix); 
    while((ix= getchar()) != '\n' && ix != EOF);

    if(ix < 10){
        printf("Number less than 10\n");
        final = ix;
    }else{
        printf("Number larger than 10\n");
        final = ix*ix;
    }
    char buff[ix];
    fgets(buff,final, stdin);
}

void memcpySmallIntoLarge(char* s){
    char dest[256];
    memcpy(dest,s,strlen(s));
	printf("%s\n", dest);
}

void memcpySmallIntoLargeTwo(char* s){
	int n = 0;
	for(int i = 0; i<strlen(s); i++){
		n+=i;
	}
	char tmp[200];
    memcpy(tmp,s,strlen(s));
	printf("\n%s\n", tmp);
}

void memcpySafeFgets(char* s){
 	int size, width; 
    printf("Enter two numbers to add :\n");
    scanf("%d%d",&size, &width);
    while((size= getchar()) != '\n' && size != EOF);
	printf("Total of the two :%d\n", size+width);
    char tmp[50];
    memcpy(tmp, s, strlen(s));
}

void memcpySmallBufferDynamic(char* s){
    int size;
    scanf("%d",&size);
    while((size= getchar()) != '\n' && size != EOF);
    char tmp[size];
    fgets(tmp, sizeof(tmp), stdin);
    char dest[20];
    memcpy(dest,s,strlen(s));
}

void memcpyWithArithmetic(){
    int a = 4;
    int b = -5;
    int c = 2;
    int d = a+b+c;
    int e = a-b-c;
    int f = a/b*c;
    int g = a*b/c;
    int x = 35;
    printf("%d, %d, %d, %d\n", d, e, f, g);
    char bu[x];
    fgets(bu,sizeof(bu), stdin);
    char des[1];
    memcpy(des,bu,sizeof(bu));
    printf("%s\n",des);
}

void memcpyWithIf(){
    int ix;
    int final;
    printf("How many bytes do you want to store?\n");
    scanf("%d",&ix); 
    while((ix= getchar()) != '\n' && ix != EOF);

    if(ix < 10){
        printf("Number less than 10\n");
        final = ix;
    }else{
        printf("Number larger than 10\n");
        final = ix*ix;
    }
    char buff[ix];
    char src[final];
    fgets(src,final, stdin);
    printf("Here is source %s\n", src);
    memcpy(buff,src,strlen(src));
}

void memcpyWithArgs(int n){
    char test[100];
    char fin[n];
    fgets(test, 100, stdin);
    memcpy(fin,test,strlen(test));
    printf("%s\n",fin);
}

void memcpyForLoopPrint(char* s){
    int i;
    for(i = 0; i < strlen(s); i++){
        printf("%c",s[i]);
    }
    printf("\n");
    char in[256];
    memcpy(in, s, strlen(s));
    printf("%s\n",in);
}

void memcpyPlaceInArray(){
    char test[20];
    char test2[40];
    char ex[40];
    printf("%d\n", sizeof(test));
    fgets(test, 20, stdin);
    fgets(test2, 40, stdin);
    memcpy(&ex[20], test2, sizeof(test2));
    printf("%s\n",ex);
}

void memcpyWithTwoArgs(int n, char* s){
    char op[n];
    memcpy(op, s, strlen(s));
}

void memcpyWith2DArray(char* s){
    int n = 4;
    char dic[n][n];
    for(int i = 0; i < 4; i++){
        printf("Write some strings, 4 letters only!\n");
        fgets(&dic[i],30,stdin);
        printf("You wrote: %s\n", dic[i]);
    }
    memcpy(&dic[0], s, strlen(s));
}

void memcpyWithPuts(char* s){
	puts("hello");
	puts("theese ");
	puts("are ");
	puts("just");
	puts("strings");
	char final[20];
	memcpy(final, s, strlen(s));
	printf("%s",final);
}

void memcpyFunPointers(char* s){
  	int t;
	srand((unsigned) time(&t));
	int a = rand()%50;
	int b = rand()%50;
	int c = rand()%50;
	printf("%d, %d, %d\n",a,b,c);
	char dest[a+b+c]; 
    strncpy(dest, s, strlen(s));
}

int memcpyMalloc(){
    int x = 2;
    char fi[x];
    char la = (char*)malloc(x);
    char temp[100];
    fgets(temp, 100,stdin);
    memcpy(fi, temp, strlen(temp));
    printf("%s\n", fi);
}

void memcpyTwoStringArgs(char* s, char* t){
    char output[50];
    memcpy(&output[0], s, strlen(s));
    printf("First %s\n", output);
    memcpy(&output[strlen(s)], t, strlen(t));
    printf("Final %s\n", output);
}

