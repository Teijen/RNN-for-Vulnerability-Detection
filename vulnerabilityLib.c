#include <stdio.h>
#include <string.h>
#include <stdlib.h>

/*Start declalaction*/
//STRCPY
void notSafeCopy();
void notSafeDynamicCopy();
void notSafeMerging();
void notSafeDifferentSizeableString();
void notSafeDifferentSizedStrings();
void notSafeMessageOverflow();
void concatenateOverStringStrcpy();
void ignoreBufferStrcpy();
int validateBufferStrcpy(char* message);
void ignoreIndexOverflowArrysStrcpy();
void validateIndexOverflowArryStrcpy();
void strcpysLimitedInput();
void flushingAfterStrCpy();
int nonCompliantStrcpy(char* s );
void strcpyInputSplits();
char* copyOne(char* message);
//STRNCPY
void notSafeToCopy();
void notSafeDynamicCopyStrncpy();
void notSafeMergingStrncpy();
void notSafeDifferentSizeableStringStrncpy();
void notSafeDifferentSizedStringsStrncpy();
void notSafeMessageOverflowStrncpy();
void concatenateOverStringStrncpy();
void ignoreBufferStrncpy();
void validateBufferStrncpy();
void ignoreIndexOverflowArrysStrncpy();
void validateIndexOverflowArryStrncpy();
void strncpysLimitedInput();
void flushingAfterStrnCpy();
void nonCompliantStrncpy();
void strncpyInputSplits();
int catOne(char* input);
char* catTwo(char* s1, char* s2);
void vulArray();
/*End declalaction*/

int main(int argc, char* argv[]){

    /*Call start*/
    // char* inputString = copyOne(argv[1]);
    // printf("Got string form input: %s\n", inputString);
    /*Call end*/
    
    /*Call start*/
    // catOne(argv[1]);  
    /*Call end*/

    /*Call start*/
    // char* strToPrint = catTwo(argv[1], argv[2]);
    // printf("These are the concatinated strings: %s\n", strToPrint);
    /*Call end*/

    // THE FINAL ONES 

    /*Call start*/
    // notSafeCopy(); 
    /*Call end*/
    /*Call start*/
    // notSafeDynamicCopy();
    /*Call end*/
    /*Call start*/
    // notSafeMerging();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizeableString();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizedStrings();
    /*Call end*/
    /*Call start*/
    // notSafeMessageOverflow();
    /*Call end*/
    /*Call start*/
    // concatenateOverStringStrcpy();
    /*Call end*/
    /*Call start*/
    // ignoreBufferStrcpy();
    /*Call end*/
    /*Call start*/
    // validateBufferStrcpy(argv[1]);
    /*Call end*/
    /*Call start*/
    // ignoreIndexOverflowArrysStrcpy();
    /*Call end*/
    /*Call start*/
    // validateIndexOverflowArryStrcpy();
    /*Call end*/
    /*Call start*/
    // strcpysLimitedInput();
    /*Call end*/
    /*Call start*/
    // flushingAfterStrCpy();
    /*Call end*/
    /*Call start*/
    // nonCompliantStrcpy(argv[1]);
    /*Call end*/
    /*Call start*/
    // strcpyInputSplits();
    /*Call end*/


    /*Call start*/
    // notSafeToCopy();
    /*Call end*/
    /*Call start*/
    // notSafeDynamicCopyStrncpy();
    /*Call end*/

    /*Call start*/
    // notSafeMergingStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizeableStringStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizedStringsStrncpy();
    /*Call end*/
    /*Call start*/

    /*Call end*/
    /*Call start*/
    // notSafeMessageOverflowStrncpy();

    /*Call end*/
    /*Call start*/
    // concatenateOverStringStrncpy();

    /*Call end*/
    /*Call start*/
    // ignoreBufferStrncpy();
    /*Call end*/
    /*Call start*/
    // validateBufferStrncpy();
    /*Call end*/
    /*Call start*/
    // ignoreIndexOverflowArrysStrncpy();
    /*Call end*/
    /*Call start*/
    // validateIndexOverflowArryStrncpy();
    /*Call end*/
    /*Call start*/
    // strncpysLimitedInput();
    /*Call end*/
    /*Call start*/
    // flushingAfterStrnCpy();
    /*Call end*/
    /*Call start*/
    // nonCompliantStrncpy();
    /*Call end*/
    /*Call start*/
    strncpyInputSplits();
    /*Call end*/

    return 0;
}



/*funcstart*/
char* copyOne(char* inputString){
    /*Trying to copy a too long string into a fixed array size*/
    char buffer [10];
    strcpy(buffer, inputString);
}
/*funcend*/

/*funcstart*/
int catOne(char* input){
    /* Concatinate and copy too long strings into fixed array size*/
    char buffer [20];
    char* str = "Greetings: ";
    strcpy(buffer, str);
    strcat(buffer, input);
    printf("%s\n",buffer);
    return 0;
}
/*funcend*/

/*funcstart*/
char* catTwo(char* s1, char* s2){
    /* Concatinate two input strings into fixed array size*/
    char buffer [30];
    strcpy(buffer,s1);
    strcat(buffer, s2);
}
/*funcend*/

/*funcstart*/
/*funcend/*

/*funcstart*/
void vulArray(){
    /*Trying to copy a too long string into a fixed array size*/
    char x[10];
    char* str = "A string too long";
    strcpy(x, str);
    printf("%s\n",x);
}
/*funcend*/


//STRCPY 

/*funcstart*/
/*funcend*/
/*funcstart*/
void notSafeCopy(){
    char src[] = "Testing input string too long for buffer";
	char dest[14];
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}
/*funcend*/

/*funcstart*/
void notSafeDynamicCopy(){
    // No free
	char *str1 = "abcdefghijklmnop";
	char *str2 = malloc(100);
	strcpy(str2, str1); 
	str2[0] = 'A';
    // printf("%s\n", str2);
}
/*funcend*/
/*funcstart*/
void notSafeMerging(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strcpy(pd, ps);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableString(){
	char dest[15] = "abcdefghijklmn";
	char *sp = dest + 5;
	char *dp = dest + 8;
}

/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStrings(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	strcpy(src, "This is somesiteilike.com");
	strcpy(dest, src);
	printf("Final copied string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeMessageOverflow(){
	char example[50];
	strcpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void concatenateOverStringStrcpy(){
	char* str1;
	char* str2;
	str1 = strdup("String");
    str2 = strdup("test");
    printf("%s\n", str1);
	strcpy(str2,"This shall be after my backslash 0 in str1");
    printf("%s\n", str2);
	printf("New String : %s\n", strcat(str1, str2));
}
/*funcend*/
/*funcstart*/
void ignoreBufferStrcpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	strcpy(buf, s);
}
/*funcend*/
/*funcstart*/
int validateBufferStrcpy(char* s) {
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 120){
		strcpy(buf, s);
        printf("%s\n",buf);
        return 0;
    }
    return 0;
}
/*funcend*/
/*funcstart*/
void ignoreIndexOverflowArrysStrcpy(){
	char sentence[5] = "";
	char *article[5] = { "the", "a", "one", "thisIsTooLong", "any" };
	int val = rand() % 4;
	strcpy(sentence, article[val]);
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArryStrcpy(){
	char sentence[5] = "";
	char *article[5] = { "the", "a", "one", "thisIsTooLong", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strcpy(sentence, article[val]);
		printf("%s\n",sentence);
	}
}
/*funcend*/
/*funcstart*/
void strcpysLimitedInput(){
	char name[10];
	char name2[10];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strcpy(name2, name);
    printf("%s\n",name2);
}
/*funcend*/
/*funcstart*/
void flushingAfterStrCpy(){
    // Might need to remove fgets
	char* name = malloc(sizeof(char)*30);
	strcpy(name, "hello");
    
	while (!strchr(name, '\n')){
		if (!fgets(name, (sizeof name + 7), stdin)){
            printf("hollo\n");
			break;
        }
    }
	printf("%s\n",name);
    free(name);
}
/*funcend*/
/*funcstart*/
/*
int nonCompliantStrcpy(char* s) {
    // Special since get_data will not run, vulnarability is in strcpy first
	char buf[8];
	strcpy(buf, s);
    printf("%s\n,",buf);
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
    return 0;
}
*/
/*funcend*/
/*funcstart*/
void strcpyInputSplits(){
	char buffer_input[10];
	fgets(buffer_input, 9, stdin);
	strcpy(buffer_input, "hello world");
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/
/*funcstart*/
void notSafeToCopy(){
	char src[] = "Testing input string";
	char dest[14];
	strncpy(dest, src, 14);
	printf("Copied string: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDynamicCopyStrncpy(){
	char *str1 = "abcdefghijklmnopzzzzzzzzzzzzzzzz";
	char *str2 = malloc(sizeof(char)*10);
	strncpy(str2, str1, strlen(str1));
	str2[0] = 'A';
    printf("%s\n",str2);
}
/*funcend*/
/*funcstart*/
void notSafeMergingStrncpy(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strncpy(pd, ps, 20);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableStringStrncpy(){
	char dest[15] = "abcdefghijklmn";
	char *sp = dest + 5;
	char *dp = dest + 8;
    strncpy(dest, dp, 100);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStringsStrncpy(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	strncpy(src, "This is someSiteILike.com",26);
	strncpy(dest, src, 140);
	printf("Final copied string : %s\n", dest);
}

/*funcend*/
/*funcstart*/
void notSafeMessageOverflowStrncpy(){
	char example[50];
	strncpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui",86);
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void concatenateOverStringStrncpy(){
	char str1[43] = "This shall be after my backslash 0 in str1";
	char* str2;
	str2 = strdup("String");
	strncpy(str2, str1, sizeof(char)*4);
    printf("%s\n",str2);
	printf("New String : %s\n", strcat(str1, str2));
}
/*funcend*/
/*funcstart*/
void ignoreBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, s,strlen(s));
	strcat(buf, s);
}
/*funcend*/
/*funcstart*/
void validateBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, "s: ",3);
	if (!strlen(s) < 77){
		strncpy(buf, s, strlen(s));
    }
}
/*funcend*/

/*funcstart*/
void ignoreIndexOverflowArrysStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some Too Long String", "any" };
	int val = rand() % 4;
	strncpy(sentence, article[val], 10);
	printf("%s\n", sentence);
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArryStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some Too Long String", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strncpy(sentence, article[val], 10);
		printf("%s\n", sentence);
	}
}
/*funcend*/
/*funcstart*/
void strncpysLimitedInput(){
	char name[20];
	char name2[10];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 20, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strncpy(name2, name, sizeof(name));
    printf("%s\n",name2);
}
/*funcend*/
/*funcstart*/
void flushingAfterStrnCpy(){
	char name[20] = " ";
    char t [6] = "hello";
	strncpy(name, t, sizeof(t));
    printf("hello\n\n");
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	printf("final %s\n", name);
}
/*funcend*/
/*funcstart*/
/*
void nonCompliantStrncpy(void) {
	char buf[8];
	strncpy(buf, "helloworld");
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}
/*
/*funcend*/
/*funcstart*/
void strncpyInputSplits(){
	char buffer_input[10];
	fgets(buffer_input, 10, stdin);
	strncpy(buffer_input, "hello world",20);
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/