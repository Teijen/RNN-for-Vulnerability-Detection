#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>


/*Start declalaction*/
//STRCPY
void notSafeCopy();
void notSafeDynamicCopy();
void notSafeMerging();
void notSafeDifferentSizeableString();
void notSafeDifferentSizedStrings();
void notSafeMessageOverflow();
void concatenateOverStringStrcpy();
void ignoreBufferStrcpy();
int validateBufferStrcpy(char* message);
void ignoreIndexOverflowArrysStrcpy();
void validateIndexOverflowArryStrcpy();
void strcpysLimitedInput();
void flushingAfterStrCpy();
int nonCompliantStrcpy(char* s );
void strcpyInputSplits();
char* copyOne(char* message);

//STRNCPY
void notSafeToCopy();
void notSafeDynamicCopyStrncpy();
void notSafeMergingStrncpy();
void notSafeDifferentSizeableStringStrncpy();
void notSafeDifferentSizedStringsStrncpy();
void notSafeMessageOverflowStrncpy();
void concatenateOverStringStrncpy();
void ignoreBufferStrncpy();
void validateBufferStrncpy();
void ignoreIndexOverflowArrysStrncpy();
void validateIndexOverflowArryStrncpy();
void strncpysLimitedInput();
void flushingAfterStrnCpy();
void nonCompliantStrncpy();
void strncpyInputSplits();

//STRCAT
void concatenateOverString(); 
void ignoreBuffer();
void validateBuffer();
void ignoreIndexOverflowArrys();
void validateIndexOverflowArrys();
void notSafeCopyStrcat();
void notSafeDynamicCopyStrcat();
void notSafeMergingStrcat();
void notSafeDifferentSizeableStringStrcat();
void notSafeDifferentSizedStringsStrcat();
void notSafeMessageOverflowStrcat();
void inputBufferStrCat();
void StrCatMultipleScanfs();
void issueUsernameMatchStrCat();
void inputStrCat(char* s);
int catOne(char* input);
char* catTwo(char* s1, char* s2);

//SPRINT
void smallSprintf();
void limitedSprintSprintf();
void flushingUnreadSprintf(char* s);
void dynamicSprintf(int a, int b, char* s);
void tooLongStringSpritf();
void notSafeSprintf();
void notSafegetSprintf();
void notSafeSprintfMul();
void notSafegetSprintfTwo();
void overflowSprintfWithArray();
void overflowSprintfWithArrayTwo(char* s);
void overflowSprintfWithArrayThree(int a);
void inputGetSWithSprintf();
void outputWithSprintf();
int outputWithSprintfArgs(int a, int b, char* s);

//SCANF 
void inputBuffer();
void issueMultipleScanfs();
void vulArray();
void issueUsernameMatchScanf();
void scanfInput();
void shortingSplittingScanf();
void notSafeGetsScanf();
void notSafegetCopyScanf();
void notSafegetSMergeScanf();
void resizeableGetScanf();
void changeSizeStringScanf();
void overflowScanf();
void buffercopyScanf();
void vulnerableBufferScanf();
void inputWithScan();
void twoIssueMultipleScanf();


/*End declalaction*/

int main(int argc, char* argv[]){

    /*Call start*/
    // char* inputString = copyOne(argv[1]);
    // printf("Got string form input: %s\n", inputString);
    /*Call end*/
    /*Call start*/
    // catOne(argv[1]);  
    /*Call end*/
    /*Call start*/
    // char* strToPrint = catTwo(argv[1], argv[2]);
    // printf("These are the concatinated strings: %s\n", strToPrint);
    /*Call end*/



    // STRCPY
    /*Call start*/
    // notSafeCopy(); 
    /*Call end*/
    /*Call start*/
    // notSafeDynamicCopy();
    /*Call end*/
    /*Call start*/
    // notSafeMerging();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizeableString();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizedStrings();
    /*Call end*/
    /*Call start*/
    // notSafeMessageOverflow();
    /*Call end*/
    /*Call start*/
    // concatenateOverStringStrcpy();
    /*Call end*/
    /*Call start*/
    // ignoreBufferStrcpy();
    /*Call end*/
    /*Call start*/
    // validateBufferStrcpy(argv[1]);
    /*Call end*/
    /*Call start*/
    // ignoreIndexOverflowArrysStrcpy();
    /*Call end*/
    /*Call start*/
    // validateIndexOverflowArryStrcpy();
    /*Call end*/
    /*Call start*/
    // strcpysLimitedInput();
    /*Call end*/
    /*Call start*/
    // flushingAfterStrCpy();
    /*Call end*/
    /*Call start*/
    // nonCompliantStrcpy(argv[1]);
    /*Call end*/
    /*Call start*/
    // strcpyInputSplits();
    /*Call end*/

	//STRNCPY
    /*Call start*/
    // notSafeToCopy();
    /*Call end*/
    /*Call start*/
    // notSafeDynamicCopyStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeMergingStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizeableStringStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeDifferentSizedStringsStrncpy();
    /*Call end*/
    /*Call start*/
    // notSafeMessageOverflowStrncpy();
    /*Call end*/
    /*Call start*/
    // concatenateOverStringStrncpy();
    /*Call end*/
    /*Call start*/
    // ignoreBufferStrncpy();
    /*Call end*/
    /*Call start*/
    // validateBufferStrncpy();
    /*Call end*/
    /*Call start*/
    // ignoreIndexOverflowArrysStrncpy();
    /*Call end*/
    /*Call start*/
    // validateIndexOverflowArryStrncpy();
    /*Call end*/
    /*Call start*/
    // strncpysLimitedInput();
    /*Call end*/
    /*Call start*/
    // flushingAfterStrnCpy();
    /*Call end*/
    /*Call start*/
    // nonCompliantStrncpy();
    /*Call end*/
    /*Call start*/
    // strncpyInputSplits();
    /*Call end*/

	//STRCAT
	/*Call start*/
	// concatenateOverString();
	/*Call end*/
	/*Call start*/
	// ignoreBuffer();
	/*Call end*/
	/*Call start*/
	// validateBuffer();
	/*Call end*/
	/*Call start*/
	// ignoreIndexOverflowArrys();
	/*Call end*/
	/*Call start*/
	// validateIndexOverflowArrys();
	/*Call end*/
	/*Call start*/
	// notSafeCopyStrcat();
	/*Call end*/
	/*Call start*/
	// notSafeDynamicCopyStrcat();
	/*Call end*/
	/*Call start*/
	// notSafeMergingStrcat();
	/*Call end*/
	/*Call start*/
	// notSafeDifferentSizeableStringStrcat();
	/*Call end*/
	/*Call start*/
	// notSafeDifferentSizedStringsStrcat();
	/*Call end*/
	/*Call start*/
	// notSafeMessageOverflowStrcat();
	/*Call end*/
	/*Call start*/
	// inputBufferStrCat();
	/*Call end*/
	/*Call start*/
	// StrCatMultipleScanfs();
	/*Call end*/
	/*Call start*/
	// issueUsernameMatchStrCat();
	/*Call end*/
	/*Call start*/
	// inputStrCat(argv[1]);
	/*Call end*/
	/*Call start*/
	// inputBuffer();
	/*Call end*/
	/*Call start*/
	// issueMultipleScanfs();
	/*Call end*/
	/*Call start*/
	// issueUsernameMatchScanf();
	/*Call end*/
	/*Call start*/
	// scanfInput();
	/*Call end*/
	/*Call start*/
	// shortingSplittingScanf();
	/*Call end*/
	/*Call start*/
	// notSafeGetsScanf();
	/*Call end*/
	/*Call start*/
	// notSafegetCopyScanf();
	/*Call end*/
	/*Call start*/
	// notSafegetSMergeScanf();
	/*Call end*/
	/*Call start*/
	// resizeableGetScanf();
	/*Call end*/
	/*Call start*/
	// changeSizeStringScanf();
	/*Call end*/
	/*Call start*/
	// overflowScanf();
	/*Call start*/
	// buffercopyScanf();
	/*Call end*/
	/*Call start*/
	// vulnerableBufferScanf();
	/*Call end*/
	/*Call start*/
	// inputWithScan();
	/*Call end*/
	/*Call start*/
	// twoIssueMultipleScanf();
	/*Call end*/
	/*Call start*/
	// smallSprintf();
	/*Call end*/
	/*Call start*/
	// limitedSprintSprintf();
	/*Call end*/
	/*Call start*/
	// flushingUnreadSprintf(argv[1]);
	/*Call end*/
	/*Call start*/
	// dynamicSprintf(strtol(argv[1], NULL, 10),strtol( argv[2], NULL, 10), argv[3]);
	/*Call end*/
	/*Call start*/
	// tooLongStringSpritf();
	/*Call end*/
	/*Call start*/
	// notSafeSprintf();
	/*Call end*/
	/*Call start*/
	// notSafegetSprintf();
	/*Call end*/
	/*Call start*/
	// notSafeSprintfMul();
	/*Call end*/
	/*Call start*/
	// notSafegetSprintfTwo();
	/*Call end*/
	/*Call start*/
	// overflowSprintfWithArray();
	/*Call end*/
	/*Call start*/
	// overflowSprintfWithArrayTwo(argv[1]);
	/*Call end*/
	/*Call start*/
	// overflowSprintfWithArrayThree(strtol(argv[1], NULL, 10));
	/*Call end*/
	/*Call start*/
	// inputGetSWithSprintf();
	/*Call end*/
	/*Call start*/
	// outputWithSprintf(argv[1]);
	/*Call end*/
	/*Call start*/
	outputWithSprintfArgs(strtol(argv[1], NULL, 10),strtol( argv[2], NULL, 10), argv[3]);

	/*Call end*/
	/*Call start*/
	/*Call end*/
	/*Call start*/
	/*Call end*/
	/*Call end*/
    return 0;
}




/*funcstart*/
char* copyOne(char* inputString){
    /*Trying to copy a too long string into a fixed array size*/
    char buffer [10];
    strcpy(buffer, inputString);
}
/*funcend*/

/*funcstart*/
int catOne(char* input){
    /* Concatinate and copy too long strings into fixed array size*/
    char buffer [20];
    char* str = "Greetings: ";
    strcpy(buffer, str);
    strcat(buffer, input);
    printf("%s\n",buffer);
    return 0;
}
/*funcend*/

/*funcstart*/
char* catTwo(char* s1, char* s2){
    /* Concatinate two input strings into fixed array size*/
    char buffer [30];
    strcpy(buffer,s1);
    strcat(buffer, s2);
}
/*funcstart*/
void vulArray(){
    /*Trying to copy a too long string into a fixed array size*/
    char x[10];
    char* str = "A string too long";
    strcpy(x, str);
    printf("%s\n",x);
}
/*funcend*/


//STRCPY 
/*funcstart*/
void notSafeCopy(){
    char src[] = "Testing input string too long for buffer";
	char dest[14];
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}
/*funcend*/

/*funcstart*/
void notSafeDynamicCopy(){
    // No free
	char *str1 = "abcdefghijklmnop";
	char *str2 = malloc(100);
	strcpy(str2, str1); 
	str2[0] = 'A';
	free(str2);
    // printf("%s\n", str2);
}
/*funcend*/
/*funcstart*/
void notSafeMerging(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strcpy(pd, ps);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableString(){
	char dest[15] = "abcdefghijklmn";
	char *sp = dest + 5;
	char *dp = dest + 8;
}

/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStrings(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	strcpy(src, "This is somesiteilike.com");
	strcpy(dest, src);
	printf("Final copied string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeMessageOverflow(){
	char example[50];
	strcpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void concatenateOverStringStrcpy(){
	char* str1;
	char* str2;
	str1 = strdup("String");
    str2 = strdup("test");
    printf("%s\n", str1);
	strcpy(str2,"This shall be after my backslash 0 in str1");
    printf("%s\n", str2);
	printf("New String : %s\n", strcat(str1, str2));
}
/*funcend*/
/*funcstart*/
void ignoreBufferStrcpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	strcpy(buf, s);
}
/*funcend*/
/*funcstart*/
int validateBufferStrcpy(char* s) {
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 120){
		strcpy(buf, s);
        printf("%s\n",buf);
        return 0;
    }
    return 0;
}
/*funcend*/
/*funcstart*/
void ignoreIndexOverflowArrysStrcpy(){
	char sentence[5] = "";
	char *article[5] = { "the", "a", "one", "thisIsTooLong", "any" };
	int val = rand() % 4;
	strcpy(sentence, article[val]);
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArryStrcpy(){
	char sentence[5] = "";
	char *article[5] = { "the", "a", "one", "thisIsTooLong", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strcpy(sentence, article[val]);
		printf("%s\n",sentence);
	}
}
/*funcend*/
/*funcstart*/
void strcpysLimitedInput(){
	char name[10];
	char name2[10];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 10, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strcpy(name2, name);
    printf("%s\n",name2);
}
/*funcend*/
/*funcstart*/
void flushingAfterStrCpy(){
    // Might need to remove fgets
	char* name = malloc(sizeof(char)*30);
	strcpy(name, "hello");
    
	while (!strchr(name, '\n')){
		if (!fgets(name, (sizeof name + 7), stdin)){
            printf("hollo\n");
			break;
        }
    }
	printf("%s\n",name);
    free(name);
}
/*funcend*/
/*funcstart*/
/*
int nonCompliantStrcpy(char* s) {
    // Special since get_data will not run, vulnarability is in strcpy first
	char buf[8];
	strcpy(buf, s);
    printf("%s\n,",buf);
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
    return 0;
}
*/
/*funcend*/
/*funcstart*/
void strcpyInputSplits(){
	char buffer_input[10];
	fgets(buffer_input, 9, stdin);
	strcpy(buffer_input, "hello world");
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/
//STRNCPY
/*funcstart*/
void notSafeToCopy(){
	char src[] = "Testing input string";
	char dest[14];
	strncpy(dest, src, 14);
	printf("Copied string: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDynamicCopyStrncpy(){
	char *str1 = "abcdefghijklmnopzzzzzzzzzzzzzzzz";
	char *str2 = malloc(sizeof(char)*10);
	strncpy(str2, str1, strlen(str1));
	str2[0] = 'A';
    printf("%s\n",str2);
	free(str2);
}
/*funcend*/
/*funcstart*/
void notSafeMergingStrncpy(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strncpy(pd, ps, 20);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableStringStrncpy(){
	char dest[15] = "abcdefghijklmn";
	char *sp = dest + 5;
	char *dp = dest + 8;
    strncpy(dest, dp, 100);
	printf("%s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStringsStrncpy(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	strncpy(src, "This is someSiteILike.com",26);
	strncpy(dest, src, 140);
	printf("Final copied string : %s\n", dest);
}

/*funcend*/
/*funcstart*/
void notSafeMessageOverflowStrncpy(){
	char example[50];
	strncpy(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui",86);
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void concatenateOverStringStrncpy(){
	char str1[43] = "This shall be after my backslash 0 in str1";
	char* str2;
	str2 = strdup("String");
	strncpy(str2, str1, sizeof(char)*4);
    printf("%s\n",str2);
	printf("New String : %s\n", strcat(str1, str2));
}
/*funcend*/
/*funcstart*/
void ignoreBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, s,strlen(s));
	strcat(buf, s);
}
/*funcend*/
/*funcstart*/
void validateBufferStrncpy() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strncpy(buf, "s: ",3);
	if (!strlen(s) < 77){
		strncpy(buf, s, strlen(s));
    }
}
/*funcend*/

/*funcstart*/
void ignoreIndexOverflowArrysStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some Too Long String", "any" };
	int val = rand() % 4;
	strncpy(sentence, article[val], 10);
	printf("%s\n", sentence);
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArryStrncpy(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some Too Long String", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strncpy(sentence, article[val], 10);
		printf("%s\n", sentence);
	}
}
/*funcend*/
/*funcstart*/
void strncpysLimitedInput(){
	char name[20];
	char name2[10];
	for (int i = 0; i <= 3; i++){
		printf("Enter any string? ");
		if (fgets(name, 20, stdin) != NULL)
			printf("Your string is: %s\n", name);
	}
	strncpy(name2, name, sizeof(name));
    printf("%s\n",name2);
}
/*funcend*/
/*funcstart*/
void flushingAfterStrnCpy(){
	char name[20] = " ";
    char t [6] = "hello";
	strncpy(name, t, sizeof(t));
    printf("hello\n\n");
	while (!strchr(name, '\n'))
		if (!fgets(name, (sizeof name), stdin))
			break;
	printf("final %s\n", name);
}
/*funcend*/
/*funcstart*/
/*
void nonCompliantStrncpy(void) {
	char buf[8];
	strncpy(buf, "helloworld");
	if (get_data(buf, sizeof(buf))) {
		printf("User Input: %s\n", buf);
	}
	else {
		printf("Error in inputting\n");
	}
}
/*
/*funcend*/
/*funcstart*/
void strncpyInputSplits(){
	char buffer_input[10];
	fgets(buffer_input, 10, stdin);
	strncpy(buffer_input, "hello world",20);
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/

//STRCAT
/*funcstart*/
void concatenateOverString(){
	char* str1;
	char* str2;
	char str3[20] = "";
	str1 = strdup("String");
	str2 = strdup("This shall be after my backslash 0 in str1");
	strcat(str2, str1);
	strcat(str3,str2);
	printf("New String : %s\n",str3); 
}
/*funcend*/

/*funcstart*/
void ignoreBuffer() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	strcat(buf, s);  
}
/*funcend*/
/*funcstart*/
void validateBuffer() {
	char *s = "abcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyzabcdefghijklmnopqrstuvwzyz";
	char buf[80];
	strcpy(buf, "s: ");
	if (strlen(s) < 110){
		strcat(buf, s); 
	}
}
/*funcend*/
/*funcstart*/
void ignoreIndexOverflowArrys(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "some string too long", "any" };
	int val = rand() % 4;
	strcat(sentence, article[val]);
	strcat(sentence, " ");
}
/*funcend*/
/*funcstart*/
void validateIndexOverflowArrys(){
	char sentence[10] = "";
	char *article[5] = { "the", "a", "one", "still to long string ", "any" };
	int val = rand() % 4;
	if (val >= 0 && val <= 4){
		strcat(sentence, article[val]);
		strcat(sentence, " ");
	}
}
/*funcend*/
/*funcstart*/
void notSafeCopyStrcat(){
	char src[] = "Testing input string, what happened";
	char dest[14];
	strcat(dest, src);
	printf("Copied string: %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeDynamicCopyStrcat(){
	char *str1 = "abcdefghijklmnopqristuvwxyz";
	char *str2 = malloc(10);
	strcat(str2, str1);
	str2[0] = 'A';
	printf("%s final \n",str2);
	free(str2);
}
/*funcend*/
/*funcstart*/
void notSafeMergingStrcat(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *ps = src + 4;
	char *pd = dest + strlen(dest);
	strcat(pd, ps);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizeableStringStrcat(){
	char dest[15] = "abcdefghijklmn";
	char *sp = dest + 5;
	char *dp = dest + 8;
	strcat(sp, dp);
	printf("%s\n", dp);
}
/*funcend*/
/*funcstart*/
void notSafeDifferentSizedStringsStrcat(){
	char src[sizeof(char)*40];
	char dest[sizeof(char)*30];
	memset(dest, '\0', sizeof(dest));
	strcat(src, "This is aNiceWebSite.com which I like");
	strcat(dest, src);
	printf("Final copied string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafeMessageOverflowStrcat(){
	char example[50];
	strcat(example, "abcdefghijklmnopqrstuvwxyzuiowerhjklsajfkjsaifhajhfsjkaldskhfjakslhfuiowabcjdnalksjshfui");
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void inputBufferStrCat(){
	char x[sizeof(char)*100];
	char str[sizeof(char)*100];
	strcat(x,"hello world");
	fgets(str, sizeof(char)*90, stdin);
	strcat(x,str);
	printf("x = %d, str = %s", x, x);
}
/*funcend*/
/*funcstart*/
void StrCatMultipleScanfs(){
	char c [3];
	char s [4];	
	int size;
	strcat(s,"Hello world");
	printf("\nShape (l/s/t):\n");
	scanf("%d", &size);
	printf("%d\n", size);
	strcat(c,s);
}
/*funcend*/
/*funcstart*/
void issueUsernameMatchStrCat(){
	char username[20];
	char result[25];
	printf("Enter your name: ");
	fgets(username, 20, stdin);
	strcat(result,"Welcome to the program, ");
	strcat(result, username);
	printf("%s\n", result);
}
/*funcend*/
/*funcstart*/
/*funcstart*/
void inputStrCat(char *s){
	char buffer_input[10];
	strcat(buffer_input,s); 
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/
/*funcstart*/
void inputBuffer(){
	char str[100];
	scanf("%s", str);
	printf("x = %d, str = %s", str, str);
}

/*funcend*/
/*funcstart*/
void issueMultipleScanfs(){
	char c = 'q';
	int size;
	printf("\nShape (l/s/t):");
	scanf("%c", &c);
	printf("Length:\n");
	scanf("%d", &size);
}

/*funcend*/
/*funcstart*/
void issueUsernameMatchScanf(){
	char username[20];
	printf("Enter your name: ");
	scanf("%s", username);
	printf("Hello %s\n", username);
}
/*funcend*/

/*funcstart*/
void scanfInput(){
	int a = 4;
	int b = 7;
	int c = a+b;
	printf("%d Total: \n",c);
	char buffer_input[10];
	scanf("%s", &buffer_input);
	printf("You entered: %s\n", buffer_input);
}
/*funcend*/
/*funcstart*/
void shortingSplittingScanf(){
	int x;
	char str[12] = "hello good day";
	int len = 10;
	scanf("%s", str);
	for (x = 0; x <= len; x++){
		if (str[x] == '\n'){
			str[x] = '\0';
			break;
		}
	}
	printf("You entered: %s\n", str);
}
/*funcend*/
/*funcstart*/
void notSafeGetsScanf(){
	char src[16];
	char dest[14];
	fgets(src, 15, stdin);
	scanf("%s", src);
	strcpy(dest, src);
	printf("Copied string: %s\n", dest);
}

/*funcend*/
/*funcstart*/
void notSafegetCopyScanf(){
	char str1[15];
	fgets(str1, 14, stdin);
	scanf("%s", str1);
	printf("%s \n",str1);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	str2[0] = 'A';
	free(str2);
}
/*funcend*/
/*funcstart*/
void notSafegetSMergeScanf(){
	char src[] = "Test One";
	char dest[15] = "Testing second";

	char *pd = dest + strlen(dest);
	fgets(src, 6, stdin);
	scanf("%s", src);
	char *ps = src + 2;
	strcpy(pd, ps);
}
/*funcend*/
/*funcstart*/
void resizeableGetScanf(){
	char dest[100];
	scanf("%s", dest);
	char *sp = dest + 5;
	char *dp = dest + 8;
	printf(sp);
	printf(dp);
}
/*funcend*/
/*funcstart*/
void changeSizeStringScanf(){
	char src[40];
	char dest[100];
	memset(dest, '\0', sizeof(dest));
	scanf("%s", src);
	strcpy(dest, src);
	printf("Final string : %s\n", dest);
}
/*funcend*/
/*funcstart*/
void overflowScanf(){
	char example[50];
	scanf("%s", example);
	printf("%s\n", example);
}
/*funcend*/
/*funcstart*/
void buffercopyScanf(){
	char p[15];
	char* hw;
	int i;
	scanf("%s", &p);
	hw = (p + 2);
	memcpy(hw, "abc" + 2, 5);
	printf("%s\n",hw);
}
/*funcend*/
/*funcstart*/
void vulnerableBufferScanf(){
	int i;
	char username[128] = { 0 };
	printf("%s\n",username);
	char msg[2048] = { 0 };
	scanf("%s", username);
	i = read(scanf, msg, sizeof(msg) - 1);
}
/*funcend*/
/*funcstart*/
void inputWithScan(){
	int x;
	char str[100];
	scanf("%d", &x);
	scanf("%s", &str);
	printf("x = %d, str = %s", x, str);
}

/*funcend*/
/*funcstart*/
void twoIssueMultipleScanf(){
	char c = 'q';
	int size;
	printf("\nShape (l/s/t):");
	int a, b = 2;
	int num = a+b;
	char buf [sizeof(num)] = " "; 
	scanf("%s", buf);
	printf("Length:\n");
	scanf("%d", &size);
}
/*funcend*/

/*funcstart*/
void smallSprintf(){
	char buf[8];
    sprintf(buf,"AAAA%3s","XXXXXXXX");
    printf("%s\n",buf);
}
/*funcend*/
/*funcstart*/
void limitedSprintSprintf(){
	char number[5];
	int sum;
	printf("Enter any number\n");
	fgets(number, sizeof(number),stdin);
	sum = atoi(number);
	char dest[sum];
	memset(dest, 'a',sum); 
	printf("test %d\n", sum);
	char tmp[100];
	sprintf(tmp, "Final string %s", dest);
	printf("%s\n", tmp);
}

/*funcend*/
/*funcstart*/
void flushingUnreadSprintf(char* s){
	char dest[100]; 
	sprintf(dest,"%s",s);
	printf("%s\n", dest);
}
void dynamicSprintf(int a, int b, char*s){
	int c = (a * b); 
	char dest[c];
	sprintf(dest, "%s", s);
	printf(dest);
}
void tooLongStringSpritf(){
	char buf[20];
	char* str = "this is a string that is too long for buf";
	sprintf(buf,"%s", str);
	printf("%s\n", buf);
}
/*funcend*/
/*funcstart*/
void notSafeSprintf(){
	char src[40];
	char dest[1];
	fgets(src, 40, stdin);
	sprintf(dest, "%s\n", src);
	printf("Final string %s\n", dest);
}
/*funcend*/
/*funcstart*/
void notSafegetSprintf(){
	char str1[15];
	fgets(str1, 14, stdin);
	char *str2 = malloc(100);
	strcpy(str2, str1);
	memset(str2, 'a', sizeof(str2));
	str2[0] = 'A';
	sprintf(str1,"%s", str2);
	free(str2);
	printf("Final string %s\n", str1);
}
/*funcend*/
/*funcstart*/
void notSafeSprintfMul(){
	char buf [20];
	int a = 100;
	char x[30];
	memset(x,'a',a);
	printf("%s\n",x);
	sprintf(buf, " str : %s", x);
}
/*funcend*/
/*funcstart*/
void notSafegetSprintfTwo(){
	char src[] = "Test One";
	char dest[15] = "Testing second";
	char *pd = dest + strlen(dest);
	fgets(src, 10, stdin);
	char *ps = src + 2;
	printf("%s\n %s\n %s\n",src,dest,ps);
	strcpy(pd, ps);
	sprintf(dest,"%s",20);
}
/*funcend*/
/*funcstart*/
void overflowSprintfWithArray(){
	char example[5];
	example[0] = "A";
	example[1] = "B";
	example[2] = "C";
	char dest[10];

	fgets(dest, 10, stdin);
	sprintf(example,"%s\n", dest);
	printf("final : %s\n", example);
}

/*funcend*/
/*funcstart*/
void overflowSprintfWithArrayTwo(char* s){
	char example[5];
	example[0] = "A";
	example[1] = "B";
	example[2] = "C";
	sprintf(example,"%s\n", s);
	printf("final : %s\n", example);
}
/*funcend*/
/*funcstart*/
void overflowSprintfWithArrayThree(int a){
	char example[10];
	example[5] = "A";
	example[6] = "B";
	example[10] = "C";
	char rev[a];
	fgets(rev, a, stdin);
	sprintf(example,"%s\n", rev);
	printf("final : %s\n", example);
}
/*funcend*/
/*funcstart*/
void inputGetSWithSprintf(){
	int x;
	char str[100];
	char final[40] = " ";
	printf("size %d", sizeof(final));
	fgets(str, 100, stdin);
	printf("%s\n", str);
	printf("%d\n", x);
	sprintf(final, "%s", str);
	printf("FINAL %s\n", final);
}
/*funcend*/
/*funcstart*/
void outputWithSprintf(char* s){
	puts("hello");
	puts("theese ");
	puts("are ");
	puts("just");
	puts("strings");
	char final[20];
	sprintf(final, "%s", s);
	printf("%s",final);

}
int outputWithSprintfArgs(int a, int b, char* s){
	int c = (a*b);
	int d = (a-b);
	int e = (a+b);
	printf("%d\n",a);
	printf("%d\n",b);
	printf("%d\n",c);
	printf("%d\n",d);
	printf("%d\n",e);
	char output[40];
	sprintf(output, "%s", s);
	printf("%s\n",output);
	return 0;

}
/*funcend*/
/*funcstart*/

/*funcend*/
/*funcstart*/

/*funcend*/
/*funcstart*/

/*funcend*/
/*funcstart*/

/*funcend*/

/*funcend*/